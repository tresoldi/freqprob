<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Nhandu Report</title>
<style>

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
                         Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            color: #333;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            background: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
        .code-block {
            margin: 1.5rem 0;
        }
        .code-input {
            padding: 1rem;
            border-radius: 4px 4px 0 0;
            margin: 0;
        }
        .code-input pre {
            margin: 0;
            padding: 0;
            background: transparent;
        }
        .code-output {
            background: #f8f8f8;
            border: 1px solid #e1e4e8;
            border-top: none;
            padding: 1rem;
            border-radius: 0 0 4px 4px;
            margin: 0;
        }
        .error {
            color: #d73a49;
            background: #ffeef0;
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid #ffdce0;
        }
        img {
            max-width: 100%;
            height: auto;
        }

        /* Pygments syntax highlighting */
        pre { line-height: 125%; }
td.linenos .normal { color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #e6edf3; background-color: #6e7681; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #e6edf3; background-color: #6e7681; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #6e7681 }
.highlight { background: #0d1117; color: #E6EDF3 }
.highlight .c { color: #8B949E; font-style: italic } /* Comment */
.highlight .err { color: #F85149 } /* Error */
.highlight .esc { color: #E6EDF3 } /* Escape */
.highlight .g { color: #E6EDF3 } /* Generic */
.highlight .k { color: #FF7B72 } /* Keyword */
.highlight .l { color: #A5D6FF } /* Literal */
.highlight .n { color: #E6EDF3 } /* Name */
.highlight .o { color: #FF7B72; font-weight: bold } /* Operator */
.highlight .x { color: #E6EDF3 } /* Other */
.highlight .p { color: #E6EDF3 } /* Punctuation */
.highlight .ch { color: #8B949E; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #8B949E; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #8B949E; font-weight: bold; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #8B949E; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #8B949E; font-style: italic } /* Comment.Single */
.highlight .cs { color: #8B949E; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #FFA198; background-color: #490202 } /* Generic.Deleted */
.highlight .ge { color: #E6EDF3; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #E6EDF3; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #FFA198 } /* Generic.Error */
.highlight .gh { color: #79C0FF; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #56D364; background-color: #0F5323 } /* Generic.Inserted */
.highlight .go { color: #8B949E } /* Generic.Output */
.highlight .gp { color: #8B949E } /* Generic.Prompt */
.highlight .gs { color: #E6EDF3; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #79C0FF } /* Generic.Subheading */
.highlight .gt { color: #FF7B72 } /* Generic.Traceback */
.highlight .g-Underline { color: #E6EDF3; text-decoration: underline } /* Generic.Underline */
.highlight .kc { color: #79C0FF } /* Keyword.Constant */
.highlight .kd { color: #FF7B72 } /* Keyword.Declaration */
.highlight .kn { color: #FF7B72 } /* Keyword.Namespace */
.highlight .kp { color: #79C0FF } /* Keyword.Pseudo */
.highlight .kr { color: #FF7B72 } /* Keyword.Reserved */
.highlight .kt { color: #FF7B72 } /* Keyword.Type */
.highlight .ld { color: #79C0FF } /* Literal.Date */
.highlight .m { color: #A5D6FF } /* Literal.Number */
.highlight .s { color: #A5D6FF } /* Literal.String */
.highlight .na { color: #E6EDF3 } /* Name.Attribute */
.highlight .nb { color: #E6EDF3 } /* Name.Builtin */
.highlight .nc { color: #F0883E; font-weight: bold } /* Name.Class */
.highlight .no { color: #79C0FF; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #D2A8FF; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #FFA657 } /* Name.Entity */
.highlight .ne { color: #F0883E; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #D2A8FF; font-weight: bold } /* Name.Function */
.highlight .nl { color: #79C0FF; font-weight: bold } /* Name.Label */
.highlight .nn { color: #FF7B72 } /* Name.Namespace */
.highlight .nx { color: #E6EDF3 } /* Name.Other */
.highlight .py { color: #79C0FF } /* Name.Property */
.highlight .nt { color: #7EE787 } /* Name.Tag */
.highlight .nv { color: #79C0FF } /* Name.Variable */
.highlight .ow { color: #FF7B72; font-weight: bold } /* Operator.Word */
.highlight .pm { color: #E6EDF3 } /* Punctuation.Marker */
.highlight .w { color: #6E7681 } /* Text.Whitespace */
.highlight .mb { color: #A5D6FF } /* Literal.Number.Bin */
.highlight .mf { color: #A5D6FF } /* Literal.Number.Float */
.highlight .mh { color: #A5D6FF } /* Literal.Number.Hex */
.highlight .mi { color: #A5D6FF } /* Literal.Number.Integer */
.highlight .mo { color: #A5D6FF } /* Literal.Number.Oct */
.highlight .sa { color: #79C0FF } /* Literal.String.Affix */
.highlight .sb { color: #A5D6FF } /* Literal.String.Backtick */
.highlight .sc { color: #A5D6FF } /* Literal.String.Char */
.highlight .dl { color: #79C0FF } /* Literal.String.Delimiter */
.highlight .sd { color: #A5D6FF } /* Literal.String.Doc */
.highlight .s2 { color: #A5D6FF } /* Literal.String.Double */
.highlight .se { color: #79C0FF } /* Literal.String.Escape */
.highlight .sh { color: #79C0FF } /* Literal.String.Heredoc */
.highlight .si { color: #A5D6FF } /* Literal.String.Interpol */
.highlight .sx { color: #A5D6FF } /* Literal.String.Other */
.highlight .sr { color: #79C0FF } /* Literal.String.Regex */
.highlight .s1 { color: #A5D6FF } /* Literal.String.Single */
.highlight .ss { color: #A5D6FF } /* Literal.String.Symbol */
.highlight .bp { color: #E6EDF3 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #D2A8FF; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #79C0FF } /* Name.Variable.Class */
.highlight .vg { color: #79C0FF } /* Name.Variable.Global */
.highlight .vi { color: #79C0FF } /* Name.Variable.Instance */
.highlight .vm { color: #79C0FF } /* Name.Variable.Magic */
.highlight .il { color: #A5D6FF } /* Literal.Number.Integer.Long */
        
</style>
</head>
<body>
<h1>FreqProb Tutorial 3: Computational Efficiency and Memory Management</h1>
<p>This tutorial demonstrates the efficiency and memory management features of FreqProb for large-scale applications:</p>
<ol>
<li><strong>Vectorized Operations</strong> - Batch processing for performance</li>
<li><strong>Caching and Memoization</strong> - Avoiding redundant computations</li>
<li><strong>Lazy Evaluation</strong> - Computing only what's needed</li>
<li><strong>Streaming Updates</strong> - Real-time incremental learning</li>
<li><strong>Memory-Efficient Representations</strong> - Handling large vocabularies</li>
<li><strong>Memory Profiling</strong> - Monitoring and optimization</li>
</ol>
<h2>Setup</h2>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">freqprob</span>

<span class="c1"># Import efficiency features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">freqprob</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">BatchScorer</span><span class="p">,</span>
    <span class="n">DistributionMemoryAnalyzer</span><span class="p">,</span>
    <span class="n">MemoryProfiler</span><span class="p">,</span>
    <span class="n">StreamingLaplace</span><span class="p">,</span>
    <span class="n">StreamingMLE</span><span class="p">,</span>
    <span class="n">VectorizedScorer</span><span class="p">,</span>
    <span class="n">create_compressed_distribution</span><span class="p">,</span>
    <span class="n">create_lazy_mle</span><span class="p">,</span>
    <span class="n">create_sparse_distribution</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Set up plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;husl&quot;</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FreqProb Efficiency and Memory Management Tutorial&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy version: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current memory usage: </span><span class="si">{</span><span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">ModuleNotFoundError: No module named &#39;psutil&#39;
  at line 13 in code block</pre>
</div>
<h2>Creating Large-Scale Data</h2>
<p>First, let's create realistic large-scale datasets to demonstrate efficiency features.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_realistic_frequency_distribution</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">total_count</span><span class="p">,</span> <span class="n">zipf_exponent</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a realistic frequency distribution following Zipf&#39;s law.&quot;&quot;&quot;</span>
    <span class="c1"># Generate Zipfian frequencies</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">zipf</span><span class="p">(</span><span class="n">zipf_exponent</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span>

    <span class="c1"># Normalize to desired total count</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="p">(</span><span class="n">frequencies</span> <span class="o">/</span> <span class="n">frequencies</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="n">total_count</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">frequencies</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">frequencies</span><span class="p">[</span><span class="n">frequencies</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Ensure no zero counts</span>

    <span class="c1"># Create word-like keys</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;word_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">06d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="c1"># Create datasets of different sizes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating realistic datasets...&quot;</span><span class="p">)</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;small&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">),</span>
    <span class="s2">&quot;large&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">),</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Show frequency distribution characteristics</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frequency range: </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Top 10 account for </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of data&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Visualize the Zipfian distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Dataset</span><span class="se">\n</span><span class="s2">(Zipf Distribution)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Rank&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<pre class="code-output">Creating realistic datasets...
Small dataset: 1,000 words, 10,997 total count
  Frequency range: 1 - 9,998
  Top 10 account for 91.0% of data

Medium dataset: 10,000 words, 109,954 total count
  Frequency range: 1 - 54,541
  Top 10 account for 90.5% of data

Large dataset: 50,000 words, -2,193,487 total count
  Frequency range: -623985 - 1
  Top 10 account for -0.0% of data</pre>
<img src="data:image/png;base64,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7bXXcPbsWaxZs8Zlx2iWmpqKUaNGYcuWLdDpdAgPD4dOp8M//vEP3HXXXZgxYwZqa2vxz3/+E+PHj8euXbuQlZWFuLg4vPnmm3j44YcxefJk3HbbbQCAQYMGAQC++uorHD9+HNOnT0diYiJ++OEHvP322/jhhx/w7bffWhLh7373O3z88ceYOXMmMjIyUFFRgf/973/48ccfMWTIEADA5s2bkZubi+zsbMyfPx8KhcKShL755hsMHz4ct912G44cOYIPPvgAr7zyCmJjYwHA8iBBRNQV6enpGDlyJD744APk5uYCANavX4+amhrceeed+Pvf/97mMw899BBWrFiB6dOn4/e//z1OnDiB119/Hfv378e2bdsQGBgIAJg3bx6eeeYZ3HTTTbjpppuwb98+3HDDDWhqanL6cSxatAhBQUGYM2cOjh07htdeew2BgYFQKBSoqqrCggUL8O2332LFihXo0aMH5s2b16Wfd++992Ljxo346quv0LdvXwAtc4+EhoaioKAAoaGh2Lx5M+bNmwedTocXX3wRAPDkk0+ipqYGZ8+exSuvvAIACA0NBQCbchTQkofuuusuXH/99Xj++ecBAD/++CO2bduGWbNmAWgZljdq1CicO3cODz30EFJTU7F9+3bMnTsXFy5cwJIlS6zmOyIiV7D1Xme2fPlyNDY24sEHH4RarUZ0dDT279+PG2+8Ed26dcPChQthMpnw1FNPtfv38bPPPou//vWvmDp1Kh544AGUlZXhtddew3XXXYf9+/e3+2W9re699178+c9/xsaNGzFjxgwAtj0rWPv7/s0330T//v0xceJEBAQE4N///jceeeQRiKJoeS4rLS3FDTfcgLi4OMyZMweRkZE4efIkPvnkk1Yx2pKzlyxZgkcffRShoaF48sknAQAJCQkOnxfyABKRh9q4caOkVColpVIpjRw5UnriiSekL7/8UmpqamqzLQBJrVZLJ06csLS99dZbEgApMTFR0ul0lva5c+dKAFptW19f32afixYtkgRBkE6dOmVpmz9/vnT5P5u0tDQpLy/P6vEAkPLz8zt8f9asWRIA6cCBA5IkSZLRaJQMBkOrbaqqqqSEhATp/vvvt7SVlZVJAKT58+e32Wd7x/XBBx9IAKStW7da2iIiIjqNTRRFqU+fPtL48eMlURRb7b9Hjx7SuHHjLG0vvvhim/NLRNQVy5cvlwBIu3fvll5//XUpLCzMcn/79a9/LY0ZM0aSpJb78c0332z53DfffCMBkP7v//6v1f42bNjQqr20tFRSqVTSzTff3Ooe9+c//1kC0Ooev2XLFgmAtGXLFktbR3lg1KhR0qhRo9p8dsCAAa1y2V133SUJgiDl5ua2+vzIkSOltLQ0q+cnLy9PCgkJ6fD9/fv3SwCkP/zhD5a29vLDQw89JAUHB0uNjY2WtptvvrndGGzNUbNmzZLCw8Mlo9HYYXxPP/20FBISIh05cqRV+5w5cySlUimdPn1akqTO8x0Rkb0uzS0dsfVed+LECQmAFB4eLpWWlrbafsKECVJwcLB07tw5S9vRo0elgICAVs8VJ0+elJRKpfTss8+2+vz3338vBQQEtGl35HgiIiKkwYMHW17b+qzQ2d/37e1j/PjxUs+ePS2vP/30U6ux2ZqzJUmS+vfv3yq/knfj8D3yWOPGjcOOHTswceJEHDhwAC+88ALGjx+P5ORkfP755222v/766y3DCgBgxIgRAIDbb78dYWFhbdqPHz9uabt0XLVer0d5eTmuvvpqSJKE/fv3O/vQ2mX+9tm8MoZSqbSMQRdFEZWVlTAajRg6dGibYXUdufS4GhsbUV5ejquuugoAWu0jMjISO3fuxPnz59vdT1FREY4ePYq7774bFRUVKC8vR3l5OfR6Pa6//nps3bq1S6s7ERHZaurUqWhoaMAXX3yB2tpafPHFFx0O3VuzZg0iIiIwbtw4y32rvLwc2dnZCA0NtQy/2LRpE5qamvDoo4+2Gkrx2GOPueQY7rvvPksPLaAlL0mS1GYYw4gRI3DmzBkYjcYu/bzL8wvQOj/U1taivLwc1157Lerr63H48GGr+7Q1R0VGRkKv17cacnm5NWvW4Nprr0VUVFSr65STkwOTyYStW7fafcxERM5g79/jt99+e6seUCaTCZs2bcKkSZOQlJRkae/du7elx6/ZJ598AlEUMXXq1Fb3wsTERPTp06fd4dH2Cg0N7TAXdPas0JlL91FTU4Py8nKMGjUKx48fR01NDQBYenh98cUXaG5ubnc/tuZs8j0cvkcebdiwYfjkk0/Q1NSEAwcO4NNPP8Urr7yCKVOmoKioCBkZGZZtU1NTW302IiICAJCSktJu+6Vjk0+fPo158+bh888/bzPPiPlm6mp1dXUA0KqAtnLlSrz88ss4fPhwqxt4jx49bNpnZWUlFi5ciA8//LDN5PCXHtcLL7yAvLw8pKSkIDs7GzfddBPuu+8+9OzZEwBw9OhRAEBeXl6HP6umpgZRUVE2xUVE5Ki4uDjk5OTg/fffR319PUwmE6ZMmdLutkePHkVNTU2beQjNzPfFU6dOAQD69OnT5me54r5mT74SRRE1NTWIiYlx+Oe1l19++OEH/OUvf8HmzZvbrMxna96zJUc98sgj+Oijj5Cbm4vk5GTccMMNmDp1Km688UbLNkePHsV3333X4VBvb13chIh8gz1/j1/eVlpaioaGBvTu3bvNtpe3HT16FJIktclFZpd+meGourq6VjnR1meFzmzbtg3z58/Hjh07UF9f32YfERERGDVqFG6//XYsXLgQr7zyCkaPHo1Jkybh7rvvtqyca2vOJt/DohR5BZVKhWHDhmHYsGHo27cvpk+fjjVr1mD+/PmWbZRKZbuf7ahdkiQALd9gjBs3DpWVlfjTn/6EK664AiEhITh37hymTZvmth5ABw8ehFKptCSz9957D9OmTcOkSZPw+OOPIz4+HkqlEosWLcLPP/9s0z6nTp2K7du34/HHH0dWVhZCQ0MhiiJuvPHGVsc1depUXHvttfj000+xceNGvPjii3j++efxySefIDc317Ltiy++2GbsvJn5m3giIle7++67MWPGDBQXFyM3N7fDOTZEUUR8fDz+7//+r933nTXfXXsT1QIt+aW9HORovnLUwYMHAfzyAFRdXY1Ro0YhPDwcTz31FHr16gWNRoN9+/bhT3/6k015z9YcFR8fj6KiInz55ZdYv3491q9fj+XLl+O+++7DypUrAbRcp3HjxuGJJ55o92eZ58EiInI3e/8e78qqdqIoQhAErF+/vt180NW/tc+ePYuamppWxTBbnxU68vPPP+P666/HFVdcgcWLFyMlJQUqlQr/+c9/8Morr1j2IQgCPv74Y3z77bf497//jS+//BL3338/Xn75ZXz77beWn+uOnE2eh0Up8jrmJU4vXLjglP19//33OHLkCFauXIn77rvP0t7ZUANnO336NP773/9i5MiRlm+yP/74Y/Ts2ROffPJJqweeSwtxQMcPQ1VVVSgsLMTChQtbTZJr7vV0uW7duuGRRx7BI488gtLSUgwZMgTPPvsscnNz0atXLwBAeHg4cnJyOj2WjuIhInKWyZMn46GHHsK3336L1atXd7hdr169sGnTJvzqV7/q9EEhLS0NQMv90dxDFADKysra9J5tT1RUFKqrq9u0nzp1qtX+5LJq1SoIgoBx48YBaFkFqqKiAp988gmuu+46y3YnTpxo89mO7um25iig5YulCRMmYMKECRBFEY888gjeeust/PWvf0Xv3r3Rq1cv1NXVMb8Qkcex517Xnvj4eGg0Ghw7dqzNe5e39erVC5IkoUePHi4pxq9atQoAMH78eAD2PSt0dP/997//DYPBgM8//7xVL+COhtpdddVVuOqqq/Dss8/i/fffx29+8xt8+OGHeOCBB2zO2Z3FQ96Jc0qRx9qyZUu73w7/5z//AQD069fPKT/H/E3EpT9LkqQ2y1W7SmVlJe666y6YTCbLChIdxbVz507s2LGj1eeDg4MBoM0DUXufB4AlS5a0em0ymdp0z42Pj0dSUpJlKfLs7Gz06tULL730kmUYyKXKysos/x0SEtJuPEREzhIaGoo333wTCxYswIQJEzrcburUqTCZTHj66afbvGc0Gi33qZycHAQGBuK1115rdc+8/H7ZkV69euHbb79ttVLfF1980eUlvJ3hb3/7GzZu3Ig77rjDMiSkvfzQ1NSEN954o83nQ0JC2h3CYWuOunRZcQBQKBSWFfPMOWbq1KnYsWMHvvzyyzY/p7q62jKnVkf5jojIVWy913X2+ZycHKxdu7bV3K3Hjh3D+vXrW2172223QalUYuHChW3+fpckqc391B6bN2/G008/jR49euA3v/mNJTbzvi/VXu7r6O/79vZRU1OD5cuXt9quqqqqzc8xj764NBfYkrPN8TAX+A72lCKP9eijj6K+vh6TJ0/GFVdcgaamJmzfvh2rV69Geno6pk+f7pSfc8UVV6BXr16YPXs2zp07h/DwcPzrX/+y6dtxex05cgTvvfceJEmCTqfDgQMHsGbNGtTV1WHx4sWt5ti45ZZb8Mknn2Dy5Mm4+eabceLECSxduhQZGRmtCkNBQUHIyMjA6tWr0bdvX0RHR2PAgAEYMGAArrvuOrzwwgtobm5GcnIyNm7c2Oab8NraWnTv3h1TpkxBZmYmQkNDsWnTJuzevRsvv/wygJaHiH/84x/Izc1F//79MX36dCQnJ+PcuXPYsmULwsPD8e9//xtASwELaFlK/M4770RgYCAmTJhgSWZERM7Q2Rx3ZqNGjcJDDz2ERYsWoaioCDfccAMCAwNx9OhRrFmzBq+++iqmTJmCuLg4zJ49G4sWLcItt9yCm266Cfv378f69estS1935oEHHsDHH3+MG2+8EVOnTsXPP/+M9957z9LL1B2MRiPee+89AC2T1Z46dQqff/45vvvuO4wZMwZvv/22Zdurr74aUVFRyMvLw+9//3sIgoBVq1a1+0VQdnY2Vq9ejYKCAgwbNgyhoaGYMGGCzTnqgQceQGVlJcaOHYvu3bvj1KlTeO2115CVlYUrr7wSAPD444/j888/xy233IJp06YhOzsber0e33//PT7++GOcPHkSsbGxneY7IiJHLVu2DBs2bGjTPmvWLJvvdZ1ZsGABNm7ciF/96ld4+OGHYTKZ8Prrr2PAgAEoKiqybNerVy8888wzmDt3Lk6ePIlJkyYhLCwMJ06cwKeffooHH3wQs2fPtvrz1q9fj8OHD8NoNKKkpASbN2/GV199hbS0NHz++efQaDQAWkZA2PKsAHT89/0NN9xg6Q370EMPoa6uDu+88w7i4+NbjWpZuXIl3njjDUyePBm9evVCbW0t3nnnHYSHh+Omm24CYHvONsfz5ptv4plnnkHv3r0RHx+PsWPH2nQ9yAO5c6k/InusX79euv/++6UrrrhCCg0NlVQqldS7d2/p0UcflUpKSlptC0DKz89v1WZemvXFF19s1W5eknvNmjWWtkOHDkk5OTlSaGioFBsbK82YMUM6cOCABEBavny5Zbv58+dLl/+z6Wgp8MsBsPxPoVBIkZGR0uDBg6VZs2ZJP/zwQ5vtRVGUnnvuOSktLU1Sq9XS4MGDpS+++ELKy8trszz39u3bpezsbEmlUrVaLvvs2bPS5MmTpcjISCkiIkL69a9/LZ0/f77VNgaDQXr88celzMxMKSwsTAoJCZEyMzOlN954o01M+/fvl2677TYpJiZGUqvVUlpamjR16lSpsLCw1XZPP/20lJycLCkUig6XjyUispUty1xLUsv9+Oabb27T/vbbb0vZ2dlSUFCQFBYWJg0cOFB64oknpPPnz1u2MZlM0sKFC6Vu3bpJQUFB0ujRo6WDBw+2ucebc8iWLVta/YyXX35ZSk5OltRqtfSrX/1K2rNnjzRq1KhWS1a3l386Oz5zzikrK+v0uPPy8lrlmODgYCk9PV26/fbbpY8//lgymUxtPrNt2zbpqquukoKCgqSkpCTpiSeekL788ss2x1ZXVyfdfffdUmRkpATAkn9szVEff/yxdMMNN0jx8fGSSqWSUlNTpYceeki6cOFCq3hqa2uluXPnSr1795ZUKpUUGxsrXX311dJLL70kNTU1WbbrKN8REdnLfO/t6H9nzpyx+V7X0XOHWWFhoTR48GBJpVJJvXr1kv7xj39If/zjHyWNRtNm23/961/SNddcI4WEhEghISHSFVdcIeXn50s//fSTXcejUqmkxMREady4cdKrr74q6XS6Np+x5VnBrKO/7z///HNp0KBBkkajkdLT06Xnn39eWrZsWatt9u3bJ911111SamqqpFarpfj4eOmWW26R9uzZ0yYmW3J2cXGxdPPNN0thYWESgFa5lryPIEldnD2TiIiIiIiIiGw2adIk/PDDDx3O90rkLzinFBEREREREZGLNDQ0tHp99OhR/Oc//8Ho0aPlCYjIg7CnFBEREREREZGLdOvWDdOmTUPPnj1x6tQpvPnmmzAYDNi/f79lEQoif8WJzomIiIiIiIhc5MYbb8QHH3yA4uJiqNVqjBw5Es899xwLUkRgTykiIiIiIiIiIpIB55QiIiIiIiIiIiK3Y1GKiIiIiIiIiIjcjkUpcosXXngBV1xxBURRdOjz06ZNQ3p6usM/f8OGDcjKyoJGo4EgCKiurnZ4X5dbsGABBEFw2v46M3r06FardHz99dcQBAEff/yxW35+V6+DLZYuXYrU1FQYDAaX/hwi8mzMG87BvEFE/oA5wzmYM0gOLEqRy+l0Ojz//PP405/+BIWi5Vdu2rRpEASh0/8564ZUUVGBqVOnIigoCFqtFqtWrUJISEi7265YsaJVDBqNBklJSRg/fjz+/ve/o7a21ikxnT9/HgsWLEBRUZFT9udMcsc2bdo0NDU14a233pLl5xOR/Jg32pL73twZuWNj3iDyb8wZbcl9X+6M3LExZ3gerr5HLrds2TIYjUbcddddlraHHnoIOTk57W5fWFiIFStW4KqrrrK0vfPOOw5/87F7927U1tbi6aef7vBnXu6pp55Cjx490NzcjOLiYnz99dd47LHHsHjxYnz++ecYNGiQZdu//OUvmDNnjl0xnT9/HgsXLkR6ejqysrJs/tzGjRvt+jmO6Cy2rlwHW2k0GuTl5WHx4sV49NFH3fbNEBF5DuaNtpg3Osa8QeTfmDPaYs7oGHOG52FRilxu+fLlmDhxIjQajaVt5MiRGDlyZJttL1y4gIKCAqSlpeHNN9+0tAcGBjr880tLSwEAkZGRNn8mNzcXQ4cOtbyeO3cuNm/ejFtuuQUTJ07Ejz/+iKCgIABAQEAAAgJc+0+pvr4ewcHBUKlULv051nTlOthj6tSpeOGFF7BlyxaMHTvWLT+TiDwH80bXMW8Qkb9gzug65gySE4fvkUudOHEC3333nU3fGoiiiN/85jeoqqrC+++/j6ioKMt7l48vPnnyJARBwEsvvYRXXnkFaWlpCAoKwqhRo3Dw4EHLdqNHj0ZeXh4AYNiwYRAEAdOmTXPoWMaOHYu//vWvOHXqFN577z1Le3vjvL/66itcc801iIyMRGhoKPr164c///nPAFrGZg8bNgwAMH36dEv33RUrVlhiHjBgAPbu3YvrrrsOwcHBls9ePs7bzGQy4c9//jMSExMREhKCiRMn4syZM622SU9Pb/fYL92ntdjaG+et1+vxxz/+ESkpKVCr1ejXrx9eeuklSJLUajtBEDBz5kysXbsWAwYMgFqtRv/+/bFhw4Y2MWVnZyM6OhqfffZZm/eIyLcxbzBvmDFvEJE1zBnMGWbMGd6LPaXIpbZv3w4AGDJkiNVtn376aWzZsgXPPvssrr76apv2/+6776K2thb5+flobGzEq6++irFjx+L7779HQkICnnzySfTr1w9vv/22pZtsr169HD6ee++9F3/+85+xceNGzJgxo91tfvjhB9xyyy0YNGgQnnrqKajVahw7dgzbtm0DAFx55ZV46qmnMG/ePDz44IO49tprAaDVMVdUVCA3Nxd33nkn7rnnHiQkJHQa17PPPgtBEPCnP/0JpaWlWLJkCXJyclBUVGT5lsUWtsR2KUmSMHHiRGzZsgW//e1vkZWVhS+//BKPP/44zp07h1deeaXV9v/73//wySef4JFHHkFYWBj+/ve/4/bbb8fp06cRExPTatshQ4ZYzhkR+Q/mDeaNSzFvEFFnmDOYMy7FnOGlJCIX+stf/iIBkGprazvd7uuvv5aUSqV0/fXXSyaTqc37eXl5UlpamuX1iRMnJABSUFCQdPbsWUv7zp07JQDSH/7wB0vb8uXLJQDS7t27rcZry7YRERHS4MGDLa/nz58vXfpP6ZVXXpEASGVlZR3uY/fu3RIAafny5W3eGzVqlARAWrp0abvvjRo1yvJ6y5YtEgApOTlZ0ul0lvaPPvpIAiC9+uqrlra0tDQpLy/P6j47i+3y67B27VoJgPTMM8+02m7KlCmSIAjSsWPHLG0AJJVK1artwIEDEgDptddea/OzHnzwQSkoKKhNOxH5NuaN9jFvtGDeIKJLMWe0jzmjBXOGd+DwPXKpiooKBAQEIDQ0tMNtysvLcffddyMmJgbvvfeeZdUMW0yaNAnJycmW18OHD8eIESPwn//8p0txdyY0NLTTlTHM48k/++wzhyfqU6vVmD59us3b33fffQgLC7O8njJlCrp16+bS8wAA//nPf6BUKvH73/++Vfsf//hHSJKE9evXt2rPyclp9e3RoEGDEB4ejuPHj7fZd1RUFBoaGlBfX++a4InIIzFvMG9cinmDiDrDnMGccSnmDO/EohTJSpIk3Hfffbhw4QLeffddJCYm2vX5Pn36tGnr27cvTp486aQI26qrq2t1U77cHXfcgV/96ld44IEHkJCQgDvvvBMfffSRXUkjOTnZrokGLz8PgiCgd+/eLj0PAHDq1CkkJSW1OR9XXnml5f1LpaamttlHVFQUqqqq2rRLF8eJc0UMIroU80b7mDeYN4ioLeaM9jFnMGd4EhalyKViYmJgNBo7rPa/9NJLWL9+PWbPno3x48e7OTr7nT17FjU1Nejdu3eH2wQFBWHr1q3YtGkT7r33Xnz33Xe44447MG7cOJhMJpt+jj1js23V0Q3X1picQalUtttuTgqXqqqqQnBwsEvOBRF5LuYN5o1LMW8QUWeYM5gzLsWc4Z1YlCKXuuKKKwC0rIxxuZ07d+LJJ5/EiBEj8Oyzzzq0/6NHj7ZpO3LkSJtVG5xl1apVAGA1qSkUClx//fVYvHgxDh06hGeffRabN2/Gli1bADi/In/5eZAkCceOHWt1HqKiolBdXd3ms5d/w2BPbGlpaTh//nybPwQOHz5sed9RJ06csHwLQkT+g3mDecNRzBtE/oc5gznDUcwZnoNFKXKpkSNHAgD27NnTqr26uhp33nkngoOD8cEHHyAwMNCh/a9duxbnzp2zvN61axd27tyJ3Nxcx4PuwObNm/H000+jR48e+M1vftPhdpWVlW3asrKyAAAGgwEAEBISAgDt3rgdYV4ZxOzjjz/GhQsXWp2HXr164dtvv0VTU5Ol7YsvvmiznKs9sd10000wmUx4/fXXW7W/8sorEAShS9dh3759Nq+MQkS+g3mjBfOG/Zg3iPwPc0YL5gz7MWd4jgC5AyDf1rNnTwwYMACbNm3C/fffb2n/3e9+h5MnT+KOO+7Atm3bOlyO85577ul0/71798Y111yDhx9+GAaDAUuWLEFMTAyeeOKJLsW9fv16HD58GEajESUlJdi8eTO++uorpKWl4fPPP4dGo+nws0899RS2bt2Km2++GWlpaSgtLcUbb7yB7t2745prrgHQctOOjIzE0qVLERYWhpCQEIwYMQI9evRwKN7o6Ghcc801mD59OkpKSrBkyRL07t271VKyDzzwAD7++GPceOONmDp1Kn7++We89957bZattSe2CRMmYMyYMXjyySdx8uRJZGZmYuPGjfjss8/w2GOPObwk7t69e1FZWYlbb73Voc8Tkfdi3mDecATzBpF/Ys5gznAEc4aHkWHFP/IzixcvlkJDQ6X6+npLW1pamgTA6v/MOlqm9cUXX5RefvllKSUlRVKr1dK1114rHThwoNXPd2SZVvP/VCqVlJiYKI0bN0569dVXWy2Fanb5Mq2FhYXSrbfeKiUlJUkqlUpKSkqS7rrrLunIkSOtPvfZZ59JGRkZUkBAQKtlUUeNGiX179+/3fg6Wqb1gw8+kObOnSvFx8dLQUFB0s033yydOnWqzedffvllKTk5WVKr1dKvfvUrac+ePW322Vlsl18HSZKk2tpa6Q9/+IOUlJQkBQYGSn369JFefPFFSRTFVtsBkPLz89vE1N7ysX/605+k1NTUNvsgIv/AvMG8IUnMG0RkG+YM5gxJYs7wZoIktTPrF5ET1dTUoGfPnnjhhRfw29/+1in7PHnyJHr06IEXX3wRs2fPdso+yTMYDAakp6djzpw5mDVrltzhEJEMmDfIHswbRP6NOYPswZzheTinFLlcREQEnnjiCbz44ot2LVVK/mn58uUIDAzE7373O7lDISKZMG+QPZg3iPwbcwbZgznD87CnFHklfntBRET2YN4gIiJbMWcQuQ97ShERERERERERkduxpxQREREREREREbkde0oREREREREREZHbsShFRERERERERERuFyB3AHITRRHnz59HWFgYBEGQOxwiIreRJAm1tbVISkqCQsHvKGzBnEFE/oo5wzHMG0Tkr2zNG35flDp//jxSUlLk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Px4zwOPmcfsmW+9/vnsGXEwQBIRrlACASr1B5miIiMiVnDHRuS1G9IzBggn90TMuBA1NJiz9+mcs33YCjc38pp2IiIiIfA+LUl0QFdQy2XlFHeeVIiIi54gLU+NPN16Bmwd1gyAA/ztajqe+OITTFfVyh0ZERERE5FR+W5TSarXIyMjAsGHDHN5HRFDLlFxcgY+IiJwpQKnAbUO644839ENksAolNY14Zt0hbPyhGH4+6p6IiIiIfIjfFqWcMRQjylyUqmdRioiInO/KbuFYeGt/ZKVEwiRKWL37DJZsOgpdY7PcoRERERERdZnfFqWcIdJclOLwPSIicpFQdQBmju2Ne65KQ6BSgYPnajD/sx9w8FyN3KEREVEHnDEqg4jIH7Ao1QXmolQFh+8REZELCYKAMVfE4y+3XImkyCDoGprxyldH8NHuMzCaRLnDIyKiy7hrgQwiIm/nt0UpZ3x7YS5KVXH4HhGRT/OUb7y7RwXjr7dkYPQV8QCAL38oxmOri/D21p+x/3SVrLEREREREdnLb4tSzvj2wlyUqms0wmDkct1ERL7Kk77xVgUocO9VaZg5tjeajCK2HinD65uPYcG/f2BhioiIiIi8it8WpZwhKFABdYASAFCl56SzRETkPoNTozCqXxyaTRICFQIq6prwU3Gt3GEREREREdmMRakuEAQB0SEqAECF3iBzNERE5G+y06IQHhSI+mYTFIKAfolhcodERERERGQzFqW6yFyUYk8pIiJyt8GpUZg5thfSYkLQLzEUWSmRcodERERERGQzvy1KOWvS2ujgQADsKUVERPL4dXYKesSGQBSBkxX1codDRETwnAUyiIg8nd8WpZw1aa25p1SlnivwERGR+2kClZYeUjuPV8gbDBERAfCsBTKIiDyZ3xalnIVFKSIiktuInjEAgF0nKyGKkszREBERERHZhkWpLmJRioiI5DYgKRzB6gDU1DfjpxKuwEdERERE3oFFqS66tCglSfx2mojIF3n63CABSgWGpkUB4BA+IiIiIvIeLEp1UVRwS1GqyShC32SSORoiInIFb5gbZHiPaADAnlNVaDaJMkdDRERERGSd3xalnPWttypAgTBNAACgikP4iIhIJv0SwhARHIiGJhMOnquROxwiIiIiIqv8tijlzG+9oy4O4atgUYqIiGSiUAgYnt7SW2rniUqZoyEiIiIi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JeqbTQhWKdEvMUzukIiIiIjIQX5blPKkoRiRQYEQBAGiKEHX2Cx3OERERB5rcGoUbhrQDWkxIZiSnYLBqVFyh0REREREDvLbopQnUSgERAa3DOHjvFJERESd65cYhuTIIMSGquQOhYiIiIi6gEUpDxET0vKHdSWLUkREHseThnwTEKoJAADUGYwyR0JEREREXcGilIeIZlGKiMhjedKQbwJC1ReLUo0sShERERF5MxalPASLUkRERLYJY08pIiIiIp/AopSHYFGKiIjINqHqlnkYa1mUIiIPxWHfRES2YVHKQ7AoRUREZBtzT6laDt8jIg/FYd9ERLZhUcpDxISoAbAoRUREZI15ovN6gxEmUZI5GiIiIiJyFItSHiL64rLWuoZmNJtEmaMhIiLyXCGqAAhCy3/rm9hbioiIiMhbsSjlIUJUSgQqWy5HFXtLERERdUipEBCs4gp8RERERN6ORSkPIQiCpbdUBYtSREREnQrlvFJEREREXo9FKQ8Sc3Gyc/aUIiIi6lyY+mJPKUOzzJEQERERkaN8oig1efJkREVFYcqUKXKH0iXmFfjYU4qIyLNwaW/PE6pmTykiIiIib+cTRalZs2bh3XfflTuMLjMXparqWZQiIvIkXNrb85iH79UZWJQiIiIi8lY+UZQaPXo0wsLC5A6jyyw9pepYlCIiIupMmCYQAHtKEREREXkz2YtSW7duxYQJE5CUlARBELB27do222i1WqSnp0Oj0WDEiBHYtWuX+wN1A3NRqpLD94iIiDplHr7H1feIiIiIvJfsRSm9Xo/MzExotdp231+9ejUKCgowf/587Nu3D5mZmRg/fjxKS0vdHKnrWYpSHL5HRETUqTDz6nscvkdERETktQLkDiA3Nxe5ubkdvr948WLMmDED06dPBwAsXboU69atw7JlyzBnzhy7f57BYIDBYLC81ul0AABRFCGKos37EUURkiTZ9RlrIjUBkCChocmIusYmBKtkvzwezRXXgOzDayC/rlwDXjfyZuwpRUREROT9PLrq0dTUhL1792Lu3LmWNoVCgZycHOzYscOhfS5atAgLFy5s015WVobGxkab9yOKImpqaiBJEhQK53U4C5CM0DeJOHr6ArqFq522X1/kqmtAtuM1kF9XrkFtba2LoiJyPfNE57WNzTJHQkRERESO8uiiVHl5OUwmExISElq1JyQk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z5gzrOM93TreczvHe6J1tpyjRYsW4cyZMzh58iReeuklzJgxA/PmzZMrZL/lr3nDX3OBv97f/fW+zXtx+wLkDsDblJeXw2QyISEhoVV7QkICDh8+DAAICAjAyy+/jDFjxkAURTzxxBN+s0qAO9hyDQAgJycHBw4cgF6vR/fu3bFmzRqMHDnS3eH6JFuuwbZt27B69WoMGjTIMpZ61apVGDhwoLvD9Tm2nP9Tp07hwQcftEwK+eijj/Lcy4A5wzre063jPbdzvCdaZ+u/M5Kfv+YNf80F/np/99f7Nu/F7WNRykUmTpyIiRMnyh2GX9u0aZPcIfi1a665BqIoyh2G3xo+fDiKiorkDoNsxJxhHe/pneM9t3O8J9pn2rRpcodAVvhr3vDHXOCv93fet/3nXszhe3aKjY2FUqlsM8laSUkJEhMTZYrKv/AayI/XQF48/96D18o6niPreI46x/NjHc+R9/DXa8Xj5nEDPG5/xaKUnVQqFbKzs1FYWGhpE0URhYWFXt111JvwGsiP10BePP/eg9fKOp4j63iOOsfzYx3Pkffw12vF4+Zx87h997it4fC9dtTV1eHYsWOW1ydOnEBRURGio6ORmpqKgoIC5OXlYejQoRg+fDiWLFkCvV6P6dOnyxi1b+E1kB+vgbx4/r0Hr5V1PEfW8Rx1jufHOp4j7+Gv14rH3YLHzeP2xePuEtnW/fNgW7ZskQC0+V9eXp5lm9dee01KTU2VVCqVNHz4cOnbb7+VL2AfxGsgP14DefH8ew9eK+t4jqzjOeocz491PEfew1+vFY+bx83jbuGLx90VgiRJUleKWkRERERERERERPbinFJEREREREREROR2LEoREREREREREZHbsShFRERERERERERux6IUERERERERERG5HYtSRERERERERETkdixKERERERERERGR27EoRUREREREREREbseiFBERERERERERuR2LUkRERERERERE5HYsShF5CUEQsHbtWrnDICIiL8CcQURE9mDeILmwKEXURdOmTYMgCBAEAYGBgejRoweeeOIJNDY2yh0aERF5GOYMIiKyB/MG+boAuQMg8gU33ngjli9fjubmZuzduxd5eXkQBAHPP/+83KEREZGHYc4gIiJ7MG+QL2NPKSInUKvVSExMREpKCiZNmoScnBx89dVXAICKigrcddddSE5ORnBwMAYOHIgPPvig1edHjx6N3//+93jiiScQHR2NxMRELFiwoNOfOX/+fHTr1g3fffedqw6LiIhcgDmDiIjswbxBvoxFKSInO3jwILZv3w6VSgUAaGxsRHZ2NtatW4eDBw/iwQcfxL333otdu3a1+tzKlSsREhKCnTt34oUXXsBTTz1lSTaXkiQJjz76KN5991188803GDRokFuOi4iInI85g4iI7MG8Qb5GkCRJkjsIIm82bdo0vPfee9BoNDAajTAYDFAoFPjoo49w++23t/uZW265BVdccQVeeuklAC3fXphMJnzzzTeWbYYPH46xY8fib3/7G4CWyQfXrFmDTz/9FPv378dXX32F5ORk1x8gERE5DXMGERHZg3mDfB3nlCJygjFjxuDNN9+EXq/HK6+8goCAAEuSMJlMeO655/DRRx/h3LlzaGpqgsFgQHBwcKt9XP4tRLdu3VBaWtqq7Q9/+APUajW+/fZbxMbGuvagiIjIJZgziIjIHswb5Ms4fI/ICUJCQtC7d29kZmZi2bJl2LlzJ/75z38CAF588UW8+uqr+NOf/oQtW7agqKgI48ePR1NTU6t9BAYGtnotCAJEUWzVNm7cOJw7dw5ffvmlaw+IiIhchjmDiIjswbxBvoxFKSInUygU+POf/4y//OUvaGhowLZt23DrrbfinnvuQWZmJnr27IkjR444tO+JEyfi/fffxwMPPIAPP/zQyZETEZG7MWcQEZE9mDfI17AoReQCv/71r6FUKqHVatGnTx989dVX2L59O3788Uc89NBDKCkpcXjfkydPxqpVqzB9+nR8/PHHToyaiIjkwJxBRET2YN4gX8I5pYhcICAgADNnzsQLL7yA/fv34/jx4xg/fjyCg4Px4IMPYtKkSaipqXF4/1OmTIEoirj33nuhUChw2223OTF6IiJyJ+YMIiKyB/MG+RKuvkdERERERERERG7H4XtEREREREREROR2LEoREREREREREZHbsShFRERERERERERux6IUERERERERERG5HYtSRERERERERETkdixKERERERERERGR27EoRUREREREREREbseiFBERERERERERuR2LUkRERERERERE5HYsShERERERERERkduxKEVERERERERERG7HohQREREREREREbnd/wPrDSSMHntNQwAAAABJRU5ErkJggg==" alt="Figure">
</div>
<h2>Vectorized Operations for Batch Processing</h2>
<p>Vectorized operations allow efficient batch processing of multiple elements.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="c1"># Create models for comparison</span>
<span class="n">medium_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]</span>
<span class="n">mle_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">laplace_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VECTORIZED OPERATIONS DEMONSTRATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create vectorized scorer</span>
<span class="n">vectorized_mle</span> <span class="o">=</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">mle_model</span><span class="p">)</span>

<span class="c1"># Prepare test data</span>
<span class="n">test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">1000</span><span class="p">]</span>  <span class="c1"># First 1000 words</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Compare individual vs batch scoring</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Performance Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Individual scoring (traditional approach)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">individual_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">mle_model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">]</span>
<span class="n">individual_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Batch scoring (vectorized approach)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_scores</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Individual scoring: </span><span class="si">{</span><span class="n">individual_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch scoring:      </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup:           </span><span class="si">{</span><span class="n">individual_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Verify results are equivalent</span>
<span class="n">max_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">individual_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">batch_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> (should be ~0)&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate matrix operations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matrix Operations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="c1"># Create 2D array of elements</span>
<span class="n">elements_2d</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_elements</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">test_elements</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]]</span>  <span class="c1"># 2 rows, 10 columns</span>
<span class="n">score_matrix</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">score_matrix</span><span class="p">(</span><span class="n">elements_2d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score matrix shape: </span><span class="si">{</span><span class="n">score_matrix</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample scores:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">score_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># Show first 2 rows, 5 columns</span>

<span class="c1"># Top-k most probable elements</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top-K Operations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span>

<span class="n">top_elements</span><span class="p">,</span> <span class="n">top_scores</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">top_k_elements</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 10 most probable elements:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">top_elements</span><span class="p">,</span> <span class="n">top_scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">medium_dataset</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2"> (count=</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">, prob=</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Score normalization - import the function from vectorized module</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score Normalization:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">19</span><span class="p">)</span>

<span class="n">sample_scores</span> <span class="o">=</span> <span class="n">batch_scores</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="c1"># Import the normalize_scores function from vectorized module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">freqprob.vectorized</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize_scores</span>

<span class="n">normalized_scores</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original scores range:    [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Normalized scores range:  [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized scores sum:    </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> (should be 1.0)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 110 in code block</pre>
</div>
<h2>Batch Scoring with Multiple Methods</h2>
<p>BatchScorer allows comparing multiple models efficiently.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BATCH SCORING WITH MULTIPLE METHODS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create multiple scorers</span>
<span class="n">scorers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;mle&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s2">&quot;laplace&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s2">&quot;ele&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">ELE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Create batch scorer</span>
<span class="n">batch_scorer</span> <span class="o">=</span> <span class="n">BatchScorer</span><span class="p">(</span><span class="n">scorers</span><span class="p">)</span>

<span class="c1"># Test elements (mix of frequent, rare, and unseen)</span>
<span class="n">test_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>  <span class="c1"># Frequent words</span>
    <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;unseen_word_1&quot;</span><span class="p">,</span> <span class="s2">&quot;unseen_word_2&quot;</span><span class="p">]</span>  <span class="c1"># Rare words  # Unseen words</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">scorers</span><span class="p">)</span><span class="si">}</span><span class="s2"> methods...&quot;</span><span class="p">)</span>

<span class="c1"># Batch score all methods</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_results</span> <span class="o">=</span> <span class="n">batch_scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch scoring completed in </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results by method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>
<span class="k">for</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">batch_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">test_mix</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">medium_dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="s2">&quot;frequent&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;rare&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="s2">&quot;unseen&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">element</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">element_type</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">, c=</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">&gt;3</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Visualize method comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Prepare data for plotting</span>
<span class="n">methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">batch_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">element_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Frequent&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Rare&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Unseen&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Frequent&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;Rare&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Unseen&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">methods</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">batch_results</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>

    <span class="c1"># Color bars by element type</span>
    <span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">element_types</span><span class="p">]</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)),</span> <span class="n">scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Scores&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Test Elements&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)),</span> <span class="p">[</span><span class="n">e</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="k">else</span> <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">test_mix</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">colors</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Performance analysis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method Performance Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

<span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">batch_results</span><span class="p">[</span><span class="n">method_name</span><span class="p">]</span>
    <span class="n">frequent_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">rare_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">unseen_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Frequent words: avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">frequent_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">frequent_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rare words:     avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rare_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">rare_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Unseen words:   avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">unseen_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">unseen_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 190 in code block</pre>
</div>
<h2>Caching and Memoization</h2>
<p>FreqProb automatically caches expensive computations like Simple Good-Turing.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CACHING AND MEMOIZATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Demonstrate SGT caching (if available)</span>
<span class="n">small_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simple Good-Turing Caching Demo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># First creation (cold cache)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating first SGT model (cold cache)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt1</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">first_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">first_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="c1"># Second creation (hot cache)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating second SGT model (hot cache)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt2</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">second_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">second_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Speedup from caching: </span><span class="si">{</span><span class="n">first_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">second_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

    <span class="c1"># Verify cache is working by checking results are identical</span>
    <span class="n">test_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">small_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">scores1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sgt1</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>
    <span class="n">scores2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sgt2</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>

    <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">s1</span> <span class="o">-</span> <span class="n">s2</span><span class="p">)</span> <span class="k">for</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scores1</span><span class="p">,</span> <span class="n">scores2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum score difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> (should be 0)&quot;</span><span class="p">)</span>

    <span class="c1"># Cache statistics</span>
    <span class="n">cache_stats</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">get_cache_stats</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cache Statistics:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cache_stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Clear cache and show effect</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Clearing all caches...&quot;</span><span class="p">)</span>
    <span class="n">freqprob</span><span class="o">.</span><span class="n">clear_all_caches</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating third SGT model (cache cleared)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt3</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">third_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">third_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds (should be similar to first time)&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SGT caching demo failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This can happen with certain frequency distributions&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate custom caching for expensive operations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Custom Caching Example:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Simulate expensive computation</span>


<span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate expensive computation with caching.&quot;&quot;&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>  <span class="c1"># Simulate work</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Test caching effect</span>
<span class="n">test_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">repeated_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">test_values</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Repeat first 100 values 5 times</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repeated_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> values (many repeats)...&quot;</span><span class="p">)</span>

<span class="c1"># Without cache (clear cache first)</span>
<span class="n">expensive_computation</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_no_cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">[:</span><span class="mi">100</span><span class="p">]]</span>  <span class="c1"># Fresh computation</span>
<span class="n">no_cache_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># With cache (subsequent calls)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_with_cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">repeated_values</span><span class="p">]</span>  <span class="c1"># Many cached hits</span>
<span class="n">with_cache_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time without cache benefit: </span><span class="si">{</span><span class="n">no_cache_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time with cache benefit:    </span><span class="si">{</span><span class="n">with_cache_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup from caching:      </span><span class="si">{</span><span class="n">no_cache_time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">with_cache_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Cache info</span>
<span class="n">cache_info</span> <span class="o">=</span> <span class="n">expensive_computation</span><span class="o">.</span><span class="n">cache_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cache statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hits: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Misses: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">misses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hit rate: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cache_info</span><span class="o">.</span><span class="n">misses</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="code-output">CACHING AND MEMOIZATION
=========================

Simple Good-Turing Caching Demo:
-----------------------------------
Creating first SGT model (cold cache)...
SGT caching demo failed: name &#39;freqprob&#39; is not defined
This can happen with certain frequency distributions


Custom Caching Example:
-------------------------
Testing with 500 values (many repeats)...
Time without cache benefit: 0.1150 seconds
Time with cache benefit:    0.0003 seconds
Speedup from caching:      2155.9x

Cache statistics:
  Hits: 500
  Misses: 100
  Hit rate: 83.3%</pre>
</div>
<h2>Lazy Evaluation</h2>
<p>Lazy evaluation computes probabilities only when needed, saving time and memory.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">freqprob</span><span class="w"> </span><span class="kn">import</span> <span class="n">LazyBatchScorer</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LAZY EVALUATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Use large dataset for dramatic effect</span>
<span class="n">large_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Working with dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
<span class="p">)</span>

<span class="c1"># Create lazy and eager models</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating models...&quot;</span><span class="p">)</span>

<span class="c1"># Eager evaluation (traditional)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">eager_mle</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">eager_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eager MLE creation: </span><span class="si">{</span><span class="n">eager_creation_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Lazy evaluation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_mle</span> <span class="o">=</span> <span class="n">create_lazy_mle</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">lazy_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy MLE creation:  </span><span class="si">{</span><span class="n">lazy_creation_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creation speedup: </span><span class="si">{</span><span class="n">eager_creation_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lazy_creation_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Test queries on subset of elements</span>
<span class="n">test_subset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[::</span><span class="mi">1000</span><span class="p">]</span>  <span class="c1"># Every 1000th element</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Querying </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_subset</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Eager model queries</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">eager_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">eager_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">eager_query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Lazy model queries (first time)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">lazy_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">lazy_query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eager query time: </span><span class="si">{</span><span class="n">eager_query_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy query time:  </span><span class="si">{</span><span class="n">lazy_query_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Verify results are identical</span>
<span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">eager_score</span> <span class="o">-</span> <span class="n">lazy_score</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">eager_score</span><span class="p">,</span> <span class="n">lazy_score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">eager_scores</span><span class="p">,</span> <span class="n">lazy_scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Show lazy evaluation statistics</span>
<span class="n">computed_elements</span> <span class="o">=</span> <span class="n">lazy_mle</span><span class="o">.</span><span class="n">get_computed_elements</span><span class="p">()</span>
<span class="n">total_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span>
<span class="n">computation_ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_elements</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Lazy Evaluation Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total elements:    </span><span class="si">{</span><span class="n">total_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computed elements: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computation ratio: </span><span class="si">{</span><span class="n">computation_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory savings:    ~</span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">computation_ratio</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate repeated queries (cached)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Repeated queries (should be cached):&quot;</span><span class="p">)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_scores_repeat</span> <span class="o">=</span> <span class="p">[</span><span class="n">lazy_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">lazy_repeat_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy repeat time: </span><span class="si">{</span><span class="n">lazy_repeat_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup vs first: </span><span class="si">{</span><span class="n">lazy_query_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lazy_repeat_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Batch lazy evaluation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Batch Lazy Evaluation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Create lazy batch scorer - use the lazy_mle we already created</span>
<span class="n">lazy_batch</span> <span class="o">=</span> <span class="n">LazyBatchScorer</span><span class="p">(</span><span class="n">lazy_mle</span><span class="p">)</span>

<span class="c1"># Test batch processing</span>
<span class="n">batch_test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[::</span><span class="mi">2000</span><span class="p">]</span>  <span class="c1"># Every 2000th element</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_scores</span> <span class="o">=</span> <span class="n">lazy_batch</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch processing time: </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average per element:   </span><span class="si">{</span><span class="n">batch_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate streaming evaluation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Streaming Evaluation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create a stream of elements (some repeated)</span>
<span class="n">stream_elements</span> <span class="o">=</span> <span class="n">batch_test_elements</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># Repeat first 5 elements 3 times</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing stream of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements (with repetitions)...&quot;</span><span class="p">)</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">streaming_scores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lazy_batch</span><span class="o">.</span><span class="n">score_streaming</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">))</span>
<span class="n">streaming_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streaming processing time: </span><span class="si">{</span><span class="n">streaming_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average per element:       </span><span class="si">{</span><span class="n">streaming_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Memory usage comparison (simplified approach)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Usage Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">27</span><span class="p">)</span>

<span class="c1"># Get current process memory for comparison</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>

<span class="n">current_process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
<span class="n">current_memory</span> <span class="o">=</span> <span class="n">current_process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>

<span class="c1"># Estimate memory usage based on computed elements</span>
<span class="n">eager_total_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span>
<span class="n">lazy_computed_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span>

<span class="c1"># Estimated memory usage (simplified calculation)</span>
<span class="n">estimated_eager_memory</span> <span class="o">=</span> <span class="n">eager_total_elements</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Assume ~0.1KB per element</span>
<span class="n">estimated_lazy_memory</span> <span class="o">=</span> <span class="n">lazy_computed_elements</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Only computed elements</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current process memory:     </span><span class="si">{</span><span class="n">current_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated eager model:      </span><span class="si">{</span><span class="n">estimated_eager_memory</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB (all </span><span class="si">{</span><span class="n">eager_total_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> elements)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated lazy model:       </span><span class="si">{</span><span class="n">estimated_lazy_memory</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB (only </span><span class="si">{</span><span class="n">lazy_computed_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> computed)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computational efficiency:   </span><span class="si">{</span><span class="n">computation_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> of full computation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory efficiency:          ~</span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">computation_ratio</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% savings&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 393 in code block</pre>
</div>
<h2>Streaming Updates and Real-time Learning</h2>
<p>Streaming models allow incremental updates for real-time applications.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STREAMING UPDATES AND REAL-TIME LEARNING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Initialize streaming models</span>
<span class="n">initial_data</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;word_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)}</span>  <span class="c1"># Small initial vocabulary</span>

<span class="n">streaming_mle</span> <span class="o">=</span> <span class="n">StreamingMLE</span><span class="p">(</span><span class="n">initial_data</span><span class="p">,</span> <span class="n">max_vocabulary_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">streaming_laplace</span> <span class="o">=</span> <span class="n">StreamingLaplace</span><span class="p">(</span><span class="n">initial_data</span><span class="p">,</span> <span class="n">max_vocabulary_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial vocabulary size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum vocabulary size: 100&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Simulate streaming data</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_streaming_data</span><span class="p">(</span><span class="n">n_updates</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate streaming data with evolving vocabulary.&quot;&quot;&quot;</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Mix of existing and new words</span>
    <span class="n">existing_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">initial_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_updates</span><span class="p">):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">existing_words</span><span class="p">)</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.7</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;new_word_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">stream</span>


<span class="n">streaming_data</span> <span class="o">=</span> <span class="n">generate_streaming_data</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> streaming updates&quot;</span><span class="p">)</span>

<span class="c1"># Process streaming data and track statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing streaming data...&quot;</span><span class="p">)</span>

<span class="n">vocab_sizes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">update_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">probabilities_tracked</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;word_0&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;word_10&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;new_word_100&quot;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Update both models</span>
    <span class="n">streaming_mle</span><span class="o">.</span><span class="n">update_single</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">streaming_laplace</span><span class="o">.</span><span class="n">update_single</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>

    <span class="n">update_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">update_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">update_time</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Convert to milliseconds</span>

    <span class="c1"># Track statistics every 50 updates</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="o">.</span><span class="n">get_streaming_statistics</span><span class="p">()</span>
        <span class="n">vocab_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;vocabulary_size&quot;</span><span class="p">])</span>

        <span class="c1"># Track specific word probabilities</span>
        <span class="k">for</span> <span class="n">tracked_word</span> <span class="ow">in</span> <span class="n">probabilities_tracked</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="p">(</span><span class="n">tracked_word</span><span class="p">)</span>
            <span class="n">probabilities_tracked</span><span class="p">[</span><span class="n">tracked_word</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average update time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum update time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Final statistics</span>
<span class="n">final_stats</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="o">.</span><span class="n">get_streaming_statistics</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vocabulary size: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;vocabulary_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total count: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;total_count&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Update count: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;update_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Most frequent: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize streaming behavior</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Vocabulary size over time</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">),</span> <span class="mi">50</span><span class="p">),</span> <span class="n">vocab_sizes</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max vocabulary&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vocabulary Size Over Time&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Updates&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Vocabulary Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Update time distribution</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">update_times</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Update Time Distribution&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Update Time (ms)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Probability evolution</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probabilities_tracked</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">probs</span><span class="p">:</span>  <span class="c1"># Only plot if we have data</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
            <span class="n">probs</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">word</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Probability Evolution&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Updates&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. Model comparison on test words</span>
<span class="n">test_words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;word_0&quot;</span><span class="p">,</span> <span class="s2">&quot;word_25&quot;</span><span class="p">,</span> <span class="s2">&quot;new_word_100&quot;</span><span class="p">,</span> <span class="s2">&quot;unseen_word&quot;</span><span class="p">]</span>
<span class="n">mle_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">streaming_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>
<span class="n">laplace_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">streaming_laplace</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_words</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mle_probs</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Streaming MLE&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">laplace_probs</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Streaming Laplace&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Model Comparison After Streaming&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Test Words&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">test_words</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Key Observations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Vocabulary size stabilizes at the maximum limit&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Update times remain consistently low&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Probabilities adapt to new data in real-time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Streaming Laplace provides smoother probability estimates&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;StreamingMLE&#39; is not defined
  at line 531 in code block</pre>
</div>
<h2>Memory-Efficient Representations</h2>
<p>For large vocabularies, compressed and sparse representations can significantly reduce memory usage.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MEMORY-EFFICIENT REPRESENTATIONS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">33</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create large frequency distribution for demonstration</span>
<span class="n">large_freq_dist</span> <span class="o">=</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">250000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Original dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
<span class="p">)</span>

<span class="c1"># Memory usage of original dictionary</span>
<span class="n">original_size</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">large_freq_dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">original_size</span> <span class="o">+=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original memory usage: </span><span class="si">{</span><span class="n">original_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create different representations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating memory-efficient representations...&quot;</span><span class="p">)</span>

<span class="c1"># 1. Compressed representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">compressed_dist</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">,</span> <span class="n">quantization_levels</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">compressed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">compressed_memory</span> <span class="o">=</span> <span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="c1"># 2. Sparse representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">sparse_dist</span> <span class="o">=</span> <span class="n">create_sparse_distribution</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span>
<span class="n">sparse_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">sparse_memory</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="c1"># 3. Highly compressed representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">highly_compressed</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span>
    <span class="n">large_freq_dist</span><span class="p">,</span> <span class="n">quantization_levels</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">use_compression</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">highly_compressed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">highly_compressed_memory</span> <span class="o">=</span> <span class="n">highly_compressed</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compressed creation time:        </span><span class="si">{</span><span class="n">compressed_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sparse creation time:            </span><span class="si">{</span><span class="n">sparse_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highly compressed creation time: </span><span class="si">{</span><span class="n">highly_compressed_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Memory comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory Usage Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span>

<span class="n">representations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Original Dictionary&quot;</span><span class="p">,</span> <span class="n">original_size</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="n">compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;Sparse&quot;</span><span class="p">,</span> <span class="n">sparse_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;Highly Compressed&quot;</span><span class="p">,</span> <span class="n">highly_compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">:</span>
    <span class="n">size_mb</span> <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="n">savings</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">size</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">size_mb</span><span class="si">:</span><span class="s2">6.1f</span><span class="si">}</span><span class="s2"> MB (</span><span class="si">{</span><span class="n">savings</span><span class="si">:</span><span class="s2">+5.1f</span><span class="si">}</span><span class="s2">% vs original)&quot;</span><span class="p">)</span>

<span class="c1"># Accuracy comparison (for compressed representations)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Accuracy Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">test_sample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span>  <span class="c1"># Test on first 100 words</span>

<span class="c1"># Calculate errors for compressed representations</span>
<span class="n">compressed_errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">highly_compressed_errors</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">original_count</span> <span class="ow">in</span> <span class="n">test_sample</span><span class="p">:</span>
    <span class="n">compressed_count</span> <span class="o">=</span> <span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">highly_compressed_count</span> <span class="o">=</span> <span class="n">highly_compressed</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

    <span class="n">compressed_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_count</span> <span class="o">-</span> <span class="n">compressed_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_count</span>
    <span class="n">highly_compressed_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_count</span> <span class="o">-</span> <span class="n">highly_compressed_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_count</span>

    <span class="n">compressed_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compressed_error</span><span class="p">)</span>
    <span class="n">highly_compressed_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">highly_compressed_error</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compressed (1024 levels):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean relative error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max relative error:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Highly compressed (256 levels):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean relative error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max relative error:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Sparse distribution benefits</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sparse distribution benefits:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Stored elements: </span><span class="si">{</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_vocabulary_size</span><span class="p">()</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  Storage efficiency: </span><span class="si">{</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_vocabulary_size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of original&quot;</span>
<span class="p">)</span>

<span class="c1"># Demonstrate sparse operations</span>
<span class="n">top_10</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_top_k</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Top 10 elements: </span><span class="si">{</span><span class="n">top_10</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>  <span class="c1"># Show first 3</span>

<span class="n">mid_freq_elements</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_elements_with_count_range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Elements with count 100-1000: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">mid_freq_elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize memory usage breakdown</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Memory usage comparison</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">]</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">size</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">]</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage Comparison&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Add value labels on bars</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Accuracy vs compression trade-off</span>
<span class="n">compression_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
<span class="n">mean_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">memory_savings</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">highly_compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">memory_savings</span><span class="p">,</span> <span class="n">mean_errors</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">compression_levels</span><span class="p">):</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2"> levels&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">memory_savings</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mean_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Accuracy vs Memory Savings Trade-off&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Memory Savings (%)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Relative Error (%)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Performance comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Query Performance Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">31</span><span class="p">)</span>

<span class="n">query_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">1000</span><span class="p">]</span>

<span class="c1"># Time each representation</span>
<span class="n">query_times</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Original dictionary</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Compressed</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Compressed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Sparse</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Sparse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time_taken</span> <span class="ow">in</span> <span class="n">query_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">queries_per_sec</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">query_words</span><span class="p">)</span> <span class="o">/</span> <span class="n">time_taken</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">time_taken</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s (</span><span class="si">{</span><span class="n">queries_per_sec</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> queries/sec)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Key Insights:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Compressed representations can save 50-80% memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Sparse representations excel for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Trade-off between compression ratio and accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Query performance generally comparable&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;create_compressed_distribution&#39; is not defined
  at line 683 in code block</pre>
</div>
<h2>Memory Profiling and Monitoring</h2>
<p>FreqProb provides tools for monitoring memory usage and optimizing performance.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MEMORY PROFILING AND MONITORING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">33</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Initialize memory profiler</span>
<span class="n">profiler</span> <span class="o">=</span> <span class="n">MemoryProfiler</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory Profiling Demo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">22</span><span class="p">)</span>

<span class="c1"># Profile different operations</span>
<span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Create MLE Model&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="p">(</span>
        <span class="s2">&quot;Create Laplace Model&quot;</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Create Compressed Dist&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">])),</span>
    <span class="p">(</span>
        <span class="s2">&quot;Vectorized Scoring&quot;</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">profiling_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">op_name</span><span class="p">,</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Profiling: </span><span class="si">{</span><span class="n">op_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">profiler</span><span class="o">.</span><span class="n">profile_operation</span><span class="p">(</span><span class="n">op_name</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">operation</span><span class="p">()</span>
        <span class="c1"># Force garbage collection to clean measurement</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">get_latest_metrics</span><span class="p">()</span>
    <span class="n">profiling_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">op_name</span><span class="p">,</span> <span class="n">metrics</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory delta: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">memory_delta_mb</span><span class="si">:</span><span class="s2">+6.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Execution time: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Display profiling summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Profiling Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">summary</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">get_memory_summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total snapshots taken: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_snapshots&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fix: Use the correct keys from the actual memory summary structure</span>
<span class="k">if</span> <span class="s2">&quot;rss_memory&quot;</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">:</span>
    <span class="n">rss_memory</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;rss_memory&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak memory usage: </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;max_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory range: </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;min_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;max_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory summary not available (no snapshots taken)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Analyze memory efficiency of different representations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribution Memory Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">DistributionMemoryAnalyzer</span><span class="p">()</span>

<span class="c1"># Analyze medium dataset</span>
<span class="n">analysis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzing dataset with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Measure original distribution</span>
<span class="n">original_memory</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">measure_distribution_memory</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total memory: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Elements: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;num_elements&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  Memory per element: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;num_elements&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> KB&quot;</span>
<span class="p">)</span>

<span class="c1"># Compare all representations</span>
<span class="n">comparison</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">compare_representations</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Representation Comparison:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">repr_name</span><span class="p">,</span> <span class="n">memory_info</span> <span class="ow">in</span> <span class="n">comparison</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">repr_name</span> <span class="o">!=</span> <span class="s2">&quot;memory_savings&quot;</span> <span class="ow">and</span> <span class="n">repr_name</span> <span class="o">!=</span> <span class="s2">&quot;profiling_metrics&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">repr_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

        <span class="c1"># Fix: Handle different key structures</span>
        <span class="k">if</span> <span class="s2">&quot;total_mb&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="c1"># Original distribution uses &#39;total_mb&#39;</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total_mb&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;total&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="c1"># Other representations use &#39;total&#39; in bytes</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Memory: </span><span class="si">{</span><span class="n">memory_mb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;creation_time&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Creation time: </span><span class="si">{</span><span class="n">memory_info</span><span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Savings:&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="s2">&quot;memory_savings&quot;</span> <span class="ow">in</span> <span class="n">comparison</span><span class="p">:</span>
    <span class="n">savings</span> <span class="o">=</span> <span class="n">comparison</span><span class="p">[</span><span class="s2">&quot;memory_savings&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">saving_info</span> <span class="ow">in</span> <span class="n">savings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">saving_info</span><span class="p">[</span><span class="s1">&#39;percentage_savings&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% savings&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Absolute: </span><span class="si">{</span><span class="n">saving_info</span><span class="p">[</span><span class="s1">&#39;absolute_savings_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Memory trend monitoring</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Trend Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">23</span><span class="p">)</span>

<span class="c1"># Simulate memory usage over time</span>
<span class="n">memory_monitor</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MemoryMonitor</span><span class="p">(</span><span class="n">memory_threshold_mb</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">monitoring_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">memory_monitor</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">()</span>

<span class="c1"># Simulate workload</span>
<span class="n">workload_memory</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># Create and destroy objects to simulate memory usage</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;temp_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)}</span>
    <span class="n">temp_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">temp_data</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Check memory</span>
    <span class="n">alert</span> <span class="o">=</span> <span class="n">memory_monitor</span><span class="o">.</span><span class="n">check_memory</span><span class="p">()</span>
    <span class="n">current_memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="n">workload_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_memory</span><span class="p">)</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># Brief pause</span>
    <span class="k">del</span> <span class="n">temp_data</span><span class="p">,</span> <span class="n">temp_model</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

<span class="n">memory_monitor</span><span class="o">.</span><span class="n">stop_monitoring</span><span class="p">()</span>

<span class="c1"># Get monitoring report</span>
<span class="n">monitoring_report</span> <span class="o">=</span> <span class="n">memory_monitor</span><span class="o">.</span><span class="n">get_monitoring_report</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monitoring duration: </span><span class="si">{</span><span class="n">monitoring_report</span><span class="p">[</span><span class="s1">&#39;monitoring_duration&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory statistics:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">stat_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">monitoring_report</span><span class="p">[</span><span class="s2">&quot;memory_statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Visualize profiling results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Memory usage by operation</span>
<span class="n">op_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>
<span class="n">memory_deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="o">.</span><span class="n">memory_delta_mb</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>
<span class="n">execution_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="o">.</span><span class="n">execution_time</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)),</span> <span class="n">memory_deltas</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Operation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Operations&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Delta (MB)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">op_names</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Add value labels</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">memory_deltas</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># 2. Execution time by operation</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)),</span> <span class="n">execution_times</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Execution Time by Operation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Operations&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Execution Time (seconds)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">op_names</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 3. Memory efficiency comparison - fix to handle different key structures</span>
<span class="n">repr_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="s2">&quot;Sparse&quot;</span><span class="p">]</span>
<span class="n">memory_usage</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Extract memory usage with proper key handling</span>
<span class="k">for</span> <span class="n">repr_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;compressed&quot;</span><span class="p">,</span> <span class="s2">&quot;sparse&quot;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">repr_name</span> <span class="ow">in</span> <span class="n">comparison</span><span class="p">:</span>
        <span class="n">memory_info</span> <span class="o">=</span> <span class="n">comparison</span><span class="p">[</span><span class="n">repr_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;total_mb&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total_mb&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;total&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">memory_usage</span> <span class="ow">and</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only plot if we have valid data</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">repr_names</span><span class="p">,</span> <span class="n">memory_usage</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>

    <span class="c1"># Add percentage savings</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">usage</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">memory_usage</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Skip original</span>
            <span class="n">savings_pct</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">usage</span> <span class="o">/</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">savings_pct</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
            <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;Memory comparison data not available&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>

<span class="c1"># 4. Memory trend during workload</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workload_memory</span><span class="p">)),</span> <span class="n">workload_memory</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage During Workload&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time Steps&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add threshold line if available</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Threshold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Recommendations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Optimization Recommendations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">38</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Use compressed representations for large vocabularies (50</span><span class="si">%+ s</span><span class="s2">avings)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Consider sparse representations for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Monitor memory usage during long-running processes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Use streaming models for real-time applications with bounded memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5. Profile operations to identify memory bottlenecks&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;6. Implement garbage collection strategies for batch processing&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;MemoryProfiler&#39; is not defined
  at line 872 in code block</pre>
</div>
<h2>Performance Benchmarks and Best Practices</h2>
<p>Let's conclude with comprehensive benchmarks and practical recommendations.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PERFORMANCE BENCHMARKS AND BEST PRACTICES&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">44</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Comprehensive benchmark suite</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_comprehensive_benchmark</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run comprehensive performance benchmark.&quot;&quot;&quot;</span>

    <span class="n">benchmark_results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Test datasets of different sizes</span>
    <span class="n">test_datasets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Small (1K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Large (50K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">test_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Benchmarking </span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="n">dataset_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))]</span>

        <span class="c1"># 1. Model creation time</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">create_mle</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">create_laplace</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">create_lazy_mle_func</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">create_lazy_mle</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">models_to_test</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="n">create_mle</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="n">create_laplace</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">,</span> <span class="n">create_lazy_mle_func</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_creator</span> <span class="ow">in</span> <span class="n">models_to_test</span><span class="p">:</span>
            <span class="c1"># Creation time</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">model_creator</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># Query time</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">[:</span><span class="mi">100</span><span class="p">]]</span>
            <span class="n">query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="n">dataset_results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="n">creation_time</span><span class="p">,</span>
                <span class="s2">&quot;query_time&quot;</span><span class="p">:</span> <span class="n">query_time</span><span class="p">,</span>
                <span class="s2">&quot;queries_per_sec&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">query_time</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="c1"># 2. Vectorized vs individual scoring</span>
        <span class="n">mle_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vectorized_model</span> <span class="o">=</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">mle_model</span><span class="p">)</span>

        <span class="c1"># Individual scoring</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">mle_model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">]</span>
        <span class="n">individual_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="c1"># Batch scoring</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">vectorized_model</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span>
        <span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="n">dataset_results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;individual_time&quot;</span><span class="p">:</span> <span class="n">individual_time</span><span class="p">,</span>
            <span class="s2">&quot;batch_time&quot;</span><span class="p">:</span> <span class="n">batch_time</span><span class="p">,</span>
            <span class="s2">&quot;speedup&quot;</span><span class="p">:</span> <span class="n">individual_time</span> <span class="o">/</span> <span class="n">batch_time</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># 3. Memory representations</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5000</span><span class="p">:</span>  <span class="c1"># Only for larger datasets</span>
            <span class="c1"># Compressed</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">compressed_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># Sparse</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">sparse</span> <span class="o">=</span> <span class="n">create_sparse_distribution</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">sparse_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="n">dataset_results</span><span class="p">[</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;compressed_creation&quot;</span><span class="p">:</span> <span class="n">compressed_creation_time</span><span class="p">,</span>
                <span class="s2">&quot;sparse_creation&quot;</span><span class="p">:</span> <span class="n">sparse_creation_time</span><span class="p">,</span>
                <span class="s2">&quot;compressed_memory&quot;</span><span class="p">:</span> <span class="n">compressed</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
                <span class="s2">&quot;sparse_memory&quot;</span><span class="p">:</span> <span class="n">sparse</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_results</span>

    <span class="k">return</span> <span class="n">benchmark_results</span>


<span class="c1"># Run benchmarks</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running comprehensive benchmarks...&quot;</span><span class="p">)</span>
<span class="n">benchmark_results</span> <span class="o">=</span> <span class="n">run_comprehensive_benchmark</span><span class="p">()</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Benchmark Results:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">benchmark_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">))</span>

    <span class="c1"># Model performance</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model Performance:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="s2">&quot;Lazy MLE&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">model_name</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s creation, </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;queries_per_sec&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> queries/sec&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Vectorization performance</span>
    <span class="k">if</span> <span class="s2">&quot;Vectorization&quot;</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vectorization: </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;speedup&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x speedup&quot;</span><span class="p">)</span>

    <span class="c1"># Memory representations</span>
    <span class="k">if</span> <span class="s2">&quot;Memory Representations&quot;</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory (Compressed): </span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;compressed_memory&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory (Sparse): </span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;sparse_memory&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Performance scaling analysis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Performance Scaling Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">31</span><span class="p">)</span>

<span class="n">dataset_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">])]</span>
<span class="n">mle_creation_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lazy_creation_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">vectorization_speedups</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Small (1K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="n">mle_creation_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">][</span><span class="s2">&quot;creation_time&quot;</span><span class="p">])</span>
    <span class="n">lazy_creation_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">][</span><span class="s2">&quot;creation_time&quot;</span><span class="p">])</span>
    <span class="n">vectorization_speedups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">][</span><span class="s2">&quot;speedup&quot;</span><span class="p">])</span>

<span class="c1"># Visualize scaling</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Creation time scaling</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">mle_creation_times</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">lazy_creation_times</span><span class="p">,</span> <span class="s2">&quot;s-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Model Creation Time Scaling&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Creation Time (seconds)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Vectorization speedup</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">vectorization_speedups</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vectorization Speedup by Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Speedup Factor&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Memory usage comparison (for larger datasets)</span>
<span class="n">memory_datasets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]</span>
<span class="n">compressed_memory</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sparse_memory</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="n">memory_datasets</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;Memory Representations&quot;</span> <span class="ow">in</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">][</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span>
        <span class="n">compressed_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;compressed_memory&quot;</span><span class="p">])</span>
        <span class="n">sparse_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;sparse_memory&quot;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">compressed_memory</span> <span class="ow">and</span> <span class="n">sparse_memory</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">memory_datasets</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">compressed_memory</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sparse_memory</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sparse&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">memory_datasets</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># 4. Queries per second comparison</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="s2">&quot;Lazy MLE&quot;</span><span class="p">]</span>
<span class="n">queries_per_sec</span> <span class="o">=</span> <span class="p">{</span><span class="n">model</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">}</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Small (1K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">queries_per_sec</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s2">&quot;queries_per_sec&quot;</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="s2">&quot;Small&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Large&quot;</span><span class="p">]))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">qps_values</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries_per_sec</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">qps_values</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">width</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">qps_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Query Performance by Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Queries per Second&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;Small&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Large&quot;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Best practices summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">BEST PRACTICES SUMMARY&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">23</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; PERFORMANCE OPTIMIZATION:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Use vectorized operations for batch processing (2-10x speedup)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Choose lazy evaluation for sparse access patterns&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Implement caching for expensive computations (SGT, etc.)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Profile operations to identify bottlenecks&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; MEMORY MANAGEMENT:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Use compressed representations for large vocabularies (50</span><span class="si">%+ s</span><span class="s2">avings)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Consider sparse representations for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Implement streaming for real-time applications&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Monitor memory usage and set appropriate limits&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; TRADE-OFFS TO CONSIDER:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Accuracy vs. Memory: Higher compression = lower accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Speed vs. Memory: Eager computation = faster queries, more memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Complexity vs. Performance: Advanced methods may not always be better&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Real-time vs. Batch: Streaming good for real-time, batch good for throughput&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; CHOOSING THE RIGHT APPROACH:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Small datasets (&lt;10K): Standard implementations sufficient&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Medium datasets (10K-100K): Consider vectorization and compression&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Large datasets (&gt;100K): Use streaming, compression, and lazy evaluation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Real-time applications: Streaming models with bounded memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Batch processing: Vectorized operations with memory monitoring&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; IMPLEMENTATION CHECKLIST:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Profile your specific use case&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Choose appropriate data representations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Implement memory monitoring&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Test with realistic data sizes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Validate accuracy vs. efficiency trade-offs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Plan for scaling and growth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 1118 in code block</pre>
</div>
<h2>Summary and Next Steps</h2>
<p>In this tutorial, you learned how to optimize FreqProb for large-scale, production applications:</p>
<h3>Key Techniques Covered:</h3>
<ol>
<li><strong>Vectorized Operations</strong> - 2-10x speedup for batch processing</li>
<li><strong>Caching and Memoization</strong> - Automatic optimization for expensive computations</li>
<li><strong>Lazy Evaluation</strong> - Compute only what's needed, save memory</li>
<li><strong>Streaming Updates</strong> - Real-time learning with bounded memory</li>
<li><strong>Memory-Efficient Representations</strong> - 50-80% memory savings for large vocabularies</li>
<li><strong>Memory Profiling</strong> - Monitor and optimize memory usage</li>
</ol>
<h3>Performance Insights:</h3>
<ul>
<li><strong>Vectorization</strong> provides consistent speedups across dataset sizes</li>
<li><strong>Lazy evaluation</strong> is most beneficial for sparse access patterns</li>
<li><strong>Compressed representations</strong> offer significant memory savings with minimal accuracy loss</li>
<li><strong>Streaming models</strong> enable real-time applications with predictable memory usage</li>
</ul>
<h3>When to Use What:</h3>
<ul>
<li><strong>Small datasets</strong> (&lt;10K): Standard implementations are sufficient</li>
<li><strong>Medium datasets</strong> (10K-100K): Add vectorization and consider compression</li>
<li><strong>Large datasets</strong> (&gt;100K): Use all efficiency features</li>
<li><strong>Real-time applications</strong>: Streaming models with memory monitoring</li>
<li><strong>Batch processing</strong>: Vectorized operations with profiling</li>
</ul>
<h3>Next Steps:</h3>
<ol>
<li><strong>Apply these techniques</strong> to your specific use case</li>
<li><strong>Profile your applications</strong> to identify bottlenecks</li>
<li><strong>Try Tutorial 4</strong>: Real-world NLP Applications</li>
<li><strong>Experiment</strong> with different combinations of techniques</li>
<li><strong>Scale gradually</strong> and monitor performance metrics</li>
</ol>
<p>Remember: <strong>optimization is application-specific</strong>. Always profile your specific use case and validate that optimizations actually improve performance for your data and usage patterns!</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</body>
</html>