<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Nhandu Report</title>
<style>

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
                         Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            color: #333;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            background: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
        }
        .code-block {
            margin: 1.5rem 0;
        }
        .code-input {
            padding: 1rem;
            border-radius: 4px 4px 0 0;
            margin: 0;
        }
        .code-input pre {
            margin: 0;
            padding: 0;
            background: transparent;
        }
        .code-output {
            background: #f8f8f8;
            border: 1px solid #e1e4e8;
            border-top: none;
            padding: 1rem;
            border-radius: 0 0 4px 4px;
            margin: 0;
        }
        .error {
            color: #d73a49;
            background: #ffeef0;
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid #ffdce0;
        }
        img {
            max-width: 100%;
            height: auto;
        }

        /* Pygments syntax highlighting */
        pre { line-height: 125%; }
td.linenos .normal { color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #e6edf3; background-color: #6e7681; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #e6edf3; background-color: #6e7681; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #6e7681 }
.highlight { background: #0d1117; color: #E6EDF3 }
.highlight .c { color: #8B949E; font-style: italic } /* Comment */
.highlight .err { color: #F85149 } /* Error */
.highlight .esc { color: #E6EDF3 } /* Escape */
.highlight .g { color: #E6EDF3 } /* Generic */
.highlight .k { color: #FF7B72 } /* Keyword */
.highlight .l { color: #A5D6FF } /* Literal */
.highlight .n { color: #E6EDF3 } /* Name */
.highlight .o { color: #FF7B72; font-weight: bold } /* Operator */
.highlight .x { color: #E6EDF3 } /* Other */
.highlight .p { color: #E6EDF3 } /* Punctuation */
.highlight .ch { color: #8B949E; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #8B949E; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #8B949E; font-weight: bold; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #8B949E; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #8B949E; font-style: italic } /* Comment.Single */
.highlight .cs { color: #8B949E; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #FFA198; background-color: #490202 } /* Generic.Deleted */
.highlight .ge { color: #E6EDF3; font-style: italic } /* Generic.Emph */
.highlight .ges { color: #E6EDF3; font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #FFA198 } /* Generic.Error */
.highlight .gh { color: #79C0FF; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #56D364; background-color: #0F5323 } /* Generic.Inserted */
.highlight .go { color: #8B949E } /* Generic.Output */
.highlight .gp { color: #8B949E } /* Generic.Prompt */
.highlight .gs { color: #E6EDF3; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #79C0FF } /* Generic.Subheading */
.highlight .gt { color: #FF7B72 } /* Generic.Traceback */
.highlight .g-Underline { color: #E6EDF3; text-decoration: underline } /* Generic.Underline */
.highlight .kc { color: #79C0FF } /* Keyword.Constant */
.highlight .kd { color: #FF7B72 } /* Keyword.Declaration */
.highlight .kn { color: #FF7B72 } /* Keyword.Namespace */
.highlight .kp { color: #79C0FF } /* Keyword.Pseudo */
.highlight .kr { color: #FF7B72 } /* Keyword.Reserved */
.highlight .kt { color: #FF7B72 } /* Keyword.Type */
.highlight .ld { color: #79C0FF } /* Literal.Date */
.highlight .m { color: #A5D6FF } /* Literal.Number */
.highlight .s { color: #A5D6FF } /* Literal.String */
.highlight .na { color: #E6EDF3 } /* Name.Attribute */
.highlight .nb { color: #E6EDF3 } /* Name.Builtin */
.highlight .nc { color: #F0883E; font-weight: bold } /* Name.Class */
.highlight .no { color: #79C0FF; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #D2A8FF; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #FFA657 } /* Name.Entity */
.highlight .ne { color: #F0883E; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #D2A8FF; font-weight: bold } /* Name.Function */
.highlight .nl { color: #79C0FF; font-weight: bold } /* Name.Label */
.highlight .nn { color: #FF7B72 } /* Name.Namespace */
.highlight .nx { color: #E6EDF3 } /* Name.Other */
.highlight .py { color: #79C0FF } /* Name.Property */
.highlight .nt { color: #7EE787 } /* Name.Tag */
.highlight .nv { color: #79C0FF } /* Name.Variable */
.highlight .ow { color: #FF7B72; font-weight: bold } /* Operator.Word */
.highlight .pm { color: #E6EDF3 } /* Punctuation.Marker */
.highlight .w { color: #6E7681 } /* Text.Whitespace */
.highlight .mb { color: #A5D6FF } /* Literal.Number.Bin */
.highlight .mf { color: #A5D6FF } /* Literal.Number.Float */
.highlight .mh { color: #A5D6FF } /* Literal.Number.Hex */
.highlight .mi { color: #A5D6FF } /* Literal.Number.Integer */
.highlight .mo { color: #A5D6FF } /* Literal.Number.Oct */
.highlight .sa { color: #79C0FF } /* Literal.String.Affix */
.highlight .sb { color: #A5D6FF } /* Literal.String.Backtick */
.highlight .sc { color: #A5D6FF } /* Literal.String.Char */
.highlight .dl { color: #79C0FF } /* Literal.String.Delimiter */
.highlight .sd { color: #A5D6FF } /* Literal.String.Doc */
.highlight .s2 { color: #A5D6FF } /* Literal.String.Double */
.highlight .se { color: #79C0FF } /* Literal.String.Escape */
.highlight .sh { color: #79C0FF } /* Literal.String.Heredoc */
.highlight .si { color: #A5D6FF } /* Literal.String.Interpol */
.highlight .sx { color: #A5D6FF } /* Literal.String.Other */
.highlight .sr { color: #79C0FF } /* Literal.String.Regex */
.highlight .s1 { color: #A5D6FF } /* Literal.String.Single */
.highlight .ss { color: #A5D6FF } /* Literal.String.Symbol */
.highlight .bp { color: #E6EDF3 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #D2A8FF; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #79C0FF } /* Name.Variable.Class */
.highlight .vg { color: #79C0FF } /* Name.Variable.Global */
.highlight .vi { color: #79C0FF } /* Name.Variable.Instance */
.highlight .vm { color: #79C0FF } /* Name.Variable.Magic */
.highlight .il { color: #A5D6FF } /* Literal.Number.Integer.Long */
        
</style>
</head>
<body>
<h1>FreqProb Tutorial 3: Computational Efficiency and Memory Management</h1>
<p>This tutorial demonstrates the efficiency and memory management features of FreqProb for large-scale applications:</p>
<ol>
<li><strong>Vectorized Operations</strong> - Batch processing for performance</li>
<li><strong>Caching and Memoization</strong> - Avoiding redundant computations</li>
<li><strong>Lazy Evaluation</strong> - Computing only what's needed</li>
<li><strong>Streaming Updates</strong> - Real-time incremental learning</li>
<li><strong>Memory-Efficient Representations</strong> - Handling large vocabularies</li>
<li><strong>Memory Profiling</strong> - Monitoring and optimization</li>
</ol>
<h2>Setup</h2>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<h2>Creating Large-Scale Data</h2>
<p>First, let's create realistic large-scale datasets to demonstrate efficiency features.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_realistic_frequency_distribution</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">total_count</span><span class="p">,</span> <span class="n">zipf_exponent</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a realistic frequency distribution following Zipf&#39;s law.&quot;&quot;&quot;</span>
    <span class="c1"># Generate Zipfian frequencies</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">zipf</span><span class="p">(</span><span class="n">zipf_exponent</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span>

    <span class="c1"># Normalize to desired total count</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="p">(</span><span class="n">frequencies</span> <span class="o">/</span> <span class="n">frequencies</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">*</span> <span class="n">total_count</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">frequencies</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">frequencies</span><span class="p">[</span><span class="n">frequencies</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Ensure no zero counts</span>

    <span class="c1"># Create word-like keys</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;word_</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="s2">06d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">)]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>


<span class="c1"># Create datasets of different sizes</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating realistic datasets...&quot;</span><span class="p">)</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;small&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
    <span class="s2">&quot;medium&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">),</span>
    <span class="s2">&quot;large&quot;</span><span class="p">:</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">500000</span><span class="p">),</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Show frequency distribution characteristics</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Frequency range: </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Top 10 account for </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="w"> </span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="mi">10</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of data&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Visualize the Zipfian distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">datasets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ranks</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2"> Dataset</span><span class="se">\n</span><span class="s2">(Zipf Distribution)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Rank&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<pre class="code-output">Creating realistic datasets...
Small dataset: 1,000 words, 10,990 total count
  Frequency range: 1 - 5,115
  Top 10 account for 91.0% of data

Medium dataset: 10,000 words, 109,970 total count
  Frequency range: 1 - 95,463
  Top 10 account for 90.9% of data

Large dataset: 50,000 words, -1,544,527 total count
  Frequency range: -495397 - 1
  Top 10 account for -0.0% of data</pre>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABKYAAAGGCAYAAABBiol3AAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjYsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvq6yFwwAAAAlwSFlzAAAPYQAAD2EBqD+naQAAigNJREFUeJzs3Xl8E3X6B/DPJGmS3i30oqUHt5ZCi+UQL0CLWBQEZUFdteCKLhYXt6ssrD85vFhFEVerrLoc4qosriLqgkjBxQWUsyCXXKUcpSdt06Zt0mTm90dJJPRK0rSTNJ/36+VLMplMnplp5+k88z0ESZIkEBERERERERERdTCF3AEQEREREREREZF3YmGKiIiIiIiIiIhkwcIUERERERERERHJgoUpIiIiIiIiIiKSBQtTREREREREREQkCxamiIiIiIiIiIhIFixMERERERERERGRLFiYIiIiIiIiIiIiWbAwRUREREREREREsmBhisgBCxYsgCAINssSEhIwdepUeQIiIqJ2dfU1/vvvv4cgCPj+++9li4mIiIioM2Fhitzazz//jEmTJiE+Ph5arRYxMTEYPXo03nrrLblDc5ggCNb/VCoVunTpgtTUVMyaNQtHjhxxers1NTVYsGCB29wk7dixAwsWLEBFRYXcoRBRJ7Fy5Urr9fN///tfo/clSUJsbCwEQcBdd90lQ4Tymjp1qk2OCQgIQM+ePTFp0iT8+9//hiiKTm/7448/xtKlS10XbBu4W74jIs9myS179uyROxSXuDJXCoIArVaL6OhojBkzBn/7299QVVXl9Lbd7e/7d955BytXrpQ7DHIhFqbIbe3YsQODBw/GgQMHMH36dLz99tt49NFHoVAo8Oabb8odnlNGjx6N1atXY8WKFXj++edx3XXXYdWqVUhOTsaSJUuc2mZNTQ0WLlzoNn+o79ixAwsXLnSbxEVEnYdWq8XHH3/caPl///tfnD9/HhqNpt1juOWWW1BbW4tbbrml3b/LERqNBqtXr8bq1avxxhtv4IEHHsCJEycwadIk3HbbbdDpdE5t190KU+6U74iI3NHzzz+P1atX491338WTTz4JAHjqqacwYMAAHDx40Kltutvf9yxMdT4quQMgas5LL72E4OBg7N69GyEhITbvFRcXyxNUG/Xt2xcPPvigzbK//vWvGDduHP70pz/hmmuuwdixY2WKjojIvY0dOxZr167F3/72N6hUv/4J8/HHHyM1NRWlpaXtHoNCoYBWq23373GUSqVqlF9efPFF/PWvf8XcuXMxffp0rFmzRqboiIi8j8lkgiiKUKvVHfq96enpGDx4sPX13LlzsWXLFtx1110YP348jh49Cl9f3w6Niag1bDFFbuvUqVPo379/o6IUAERERNi8FgQBM2fOxNq1a5GYmAhfX18MHz4cP//8MwDg73//O3r37g2tVouRI0fizJkzNp//4Ycf8Jvf/AZxcXHQaDSIjY3FH//4R9TW1rbX7ll17doVn376KVQqFV566SXrcqPRiHnz5iE1NRXBwcHw9/fHzTffjK1bt1rXOXPmDMLDwwEACxcutDbdXbBgAQDg4MGDmDp1Knr27AmtVouoqCg88sgjKCsrs4mhqqoKTz31FBISEqDRaBAREYHRo0dj3759Nuv99NNPuOOOOxAcHAw/Pz+MGDEC27dvt76/YMECPPPMMwCAHj16WOO5+ngTETnj/vvvR1lZGb777jvrMqPRiM8++wwPPPBAk58RRRFLly5F//79odVqERkZiccffxzl5eU260mShBdffBHdu3eHn58fRo0ahcOHDzfaXlNjTDU31uDIkSMxcuTIRp/917/+hYULFyImJgaBgYGYNGkSKisrYTAY8NRTTyEiIgIBAQGYNm0aDAaDYwfpKnPmzMHtt9+OtWvX4vjx49blX375Je68805ER0dDo9GgV69eeOGFF2A2m23i/+abb5Cfn2+9nickJACwL0dZfPrpp0hNTUVgYCCCgoIwYMCARi2fKyoq8NRTTyE2NhYajQa9e/fGK6+8Yu2G2Fq+IyJqD/Ze686cOQNBEPDaa69h6dKl6NWrFzQajXW4ju+//x6DBw+GVqtFr1698Pe//73JsWsB4KOPPkJqaip8fX3RpUsX3HfffTh37lyb9uPWW2/Fc889h/z8fHz00UfW5fbcK7T29/2KFStw6623IiIiAhqNBomJiXj33XcbxbBnzx6MGTMGYWFh8PX1RY8ePfDII4/YrGNPzk5ISMDhw4fx3//+1xrLlbmWPBNbTJHbio+Px86dO3Ho0CEkJSW1uv4PP/yA9evXIzMzEwCwaNEi3HXXXZg9ezbeeecdPPHEEygvL8err76KRx55BFu2bLF+du3ataipqcGMGTPQtWtX7Nq1C2+9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yM3Nxe233w4fHx+cOHECa9euxZtvvolJkyYhPDwcTz/9NBYtWoS77roLY8eOxf79+7FhwwbrtNgtefTRR/HZZ5/hjjvuwOTJk3Hq1Cl89NFH1tamHcFkMuGjjz4C0DCAbX5+PtavX4+DBw9i1KhReO+996zr3nDDDQgNDUVGRgb+8Ic/QBAErF69usmHQampqVizZg2ysrIwZMgQBAQEYNy4cXbnqEcffRSXLl3Crbfeiu7duyM/Px9vvfUWUlJScO211wIAnnnmGaxfvx533XUXpk6ditTUVOj1evz888/47LPPcObMGYSFhbWY74iInLV8+XJs3Lix0fJZs2bZfa1ryYIFC7Bp0ybceOONmDFjBsxmM95++20kJSUhNzfXul6vXr3w4osvYu7cuThz5gwmTJiAwMBA5OXl4YsvvsBjjz2Gp59+utXv27BhA44dOwaTyYSioiJs2bIF3333HeLj47F+/XpotVoADT0h7LlXAJr/+/7222+3top9/PHHUV1djffffx8RERE2vVtWrVqFd955BxMnTkSvXr1QVVWF999/H0FBQRg7diwA+3O2JZ53330XL774Inr37o2IiAjceuutdp0PclMdOQUgkSM2bNggPfLII9I111wjBQQESGq1Wurdu7f05JNPSkVFRTbrApAyMzNtllmmbV28eLHNcst03WvXrrUuO3LkiJSWliYFBARIYWFh0vTp06UDBw5IAKQVK1ZY15s/f7509a9Nc9OEXw2A9T+FQiGFhIRIgwYNkmbNmiUdPny40fqiKEovv/yyFB8fL2k0GmnQoEHS119/LWVkZDSaunvHjh1SamqqpFarbabSPn/+vDRx4kQpJCRECg4Oln7zm99IBQUFNusYDAbpmWeekZKTk6XAwEDJ399fSk5Olt55551GMe3fv1+65557pK5du0oajUaKj4+XJk+eLOXk5Nis98ILL0gxMTGSQqFodmpZIiJ72TMFtiQ1XI/vvPPORsvfe+89KTU1VfL19ZUCAwOlAQMGSLNnz5YKCgqs65jNZmnhwoVSt27dJF9fX2nkyJHSoUOHGl3jLTlk69atNt/x+uuvSzExMZJGo5FuvPFGac+ePdKIESNsprNuKv+0tH+WnFNSUtLifmdkZNjkGD8/PykhIUG69957pc8++0wym82NPrN9+3bp+uuvl3x9faXo6Ghp9uzZ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" alt="Figure">
</div>
<h2>Vectorized Operations for Batch Processing</h2>
<p>Vectorized operations allow efficient batch processing of multiple elements.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="c1"># Create models for comparison</span>
<span class="n">medium_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]</span>
<span class="n">mle_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">laplace_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VECTORIZED OPERATIONS DEMONSTRATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create vectorized scorer</span>
<span class="n">vectorized_mle</span> <span class="o">=</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">mle_model</span><span class="p">)</span>

<span class="c1"># Prepare test data</span>
<span class="n">test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">1000</span><span class="p">]</span>  <span class="c1"># First 1000 words</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Compare individual vs batch scoring</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Performance Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Individual scoring (traditional approach)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">individual_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">mle_model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">]</span>
<span class="n">individual_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Batch scoring (vectorized approach)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_scores</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Individual scoring: </span><span class="si">{</span><span class="n">individual_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch scoring:      </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup:           </span><span class="si">{</span><span class="n">individual_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Verify results are equivalent</span>
<span class="n">max_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">individual_scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">batch_scores</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> (should be ~0)&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate matrix operations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Matrix Operations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="c1"># Create 2D array of elements</span>
<span class="n">elements_2d</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_elements</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">test_elements</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]]</span>  <span class="c1"># 2 rows, 10 columns</span>
<span class="n">score_matrix</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">score_matrix</span><span class="p">(</span><span class="n">elements_2d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score matrix shape: </span><span class="si">{</span><span class="n">score_matrix</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample scores:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">score_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># Show first 2 rows, 5 columns</span>

<span class="c1"># Top-k most probable elements</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Top-K Operations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span>

<span class="n">top_elements</span><span class="p">,</span> <span class="n">top_scores</span> <span class="o">=</span> <span class="n">vectorized_mle</span><span class="o">.</span><span class="n">top_k_elements</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 10 most probable elements:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">top_elements</span><span class="p">,</span> <span class="n">top_scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">medium_dataset</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">element</span><span class="si">}</span><span class="s2"> (count=</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">, prob=</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Score normalization - import the function from vectorized module</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Score Normalization:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">19</span><span class="p">)</span>

<span class="n">sample_scores</span> <span class="o">=</span> <span class="n">batch_scores</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="c1"># Import the normalize_scores function from vectorized module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">freqprob.vectorized</span><span class="w"> </span><span class="kn">import</span> <span class="n">normalize_scores</span>

<span class="n">normalized_scores</span> <span class="o">=</span> <span class="n">normalize_scores</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original scores range:    [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sample_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Normalized scores range:  [</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">]&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normalized scores sum:    </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">normalized_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> (should be 1.0)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 111 in code block</pre>
</div>
<h2>Batch Scoring with Multiple Methods</h2>
<p>BatchScorer allows comparing multiple models efficiently.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BATCH SCORING WITH MULTIPLE METHODS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create multiple scorers</span>
<span class="n">scorers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;mle&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s2">&quot;laplace&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s2">&quot;ele&quot;</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">ELE</span><span class="p">(</span><span class="n">medium_dataset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<span class="p">}</span>

<span class="c1"># Create batch scorer</span>
<span class="n">batch_scorer</span> <span class="o">=</span> <span class="n">BatchScorer</span><span class="p">(</span><span class="n">scorers</span><span class="p">)</span>

<span class="c1"># Test elements (mix of frequent, rare, and unseen)</span>
<span class="n">test_mix</span> <span class="o">=</span> <span class="p">(</span>
    <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">medium_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>  <span class="c1"># Frequent words</span>
    <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;unseen_word_1&quot;</span><span class="p">,</span> <span class="s2">&quot;unseen_word_2&quot;</span><span class="p">]</span>  <span class="c1"># Rare words  # Unseen words</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">scorers</span><span class="p">)</span><span class="si">}</span><span class="s2"> methods...&quot;</span><span class="p">)</span>

<span class="c1"># Batch score all methods</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_results</span> <span class="o">=</span> <span class="n">batch_scorer</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch scoring completed in </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results by method:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>
<span class="k">for</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">batch_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">test_mix</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">medium_dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="s2">&quot;frequent&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s2">&quot;rare&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="s2">&quot;unseen&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">element</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">element_type</span><span class="si">:</span><span class="s2">&lt;8</span><span class="si">}</span><span class="s2">, c=</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">&gt;3</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Visualize method comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Prepare data for plotting</span>
<span class="n">methods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">batch_results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">element_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Frequent&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Rare&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Unseen&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Frequent&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;Rare&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Unseen&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">methods</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">batch_results</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>

    <span class="c1"># Color bars by element type</span>
    <span class="n">bar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">element_types</span><span class="p">]</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)),</span> <span class="n">scores</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">bar_colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> Scores&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Test Elements&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span>
        <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_mix</span><span class="p">)),</span> <span class="p">[</span><span class="n">e</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="k">else</span> <span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">test_mix</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">colors</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Performance analysis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method Performance Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

<span class="k">for</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">batch_results</span><span class="p">[</span><span class="n">method_name</span><span class="p">]</span>
    <span class="n">frequent_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">rare_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">unseen_scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Frequent words: avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">frequent_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">frequent_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Rare words:     avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rare_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">rare_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;  Unseen words:   avg = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">unseen_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, std = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">unseen_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 191 in code block</pre>
</div>
<h2>Caching and Memoization</h2>
<p>FreqProb automatically caches expensive computations like Simple Good-Turing.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">lru_cache</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CACHING AND MEMOIZATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Demonstrate SGT caching (if available)</span>
<span class="n">small_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simple Good-Turing Caching Demo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">35</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># First creation (cold cache)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating first SGT model (cold cache)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt1</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">first_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">first_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="c1"># Second creation (hot cache)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating second SGT model (hot cache)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt2</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">second_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">second_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Speedup from caching: </span><span class="si">{</span><span class="n">first_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">second_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

    <span class="c1"># Verify cache is working by checking results are identical</span>
    <span class="n">test_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">small_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="n">scores1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sgt1</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>
    <span class="n">scores2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sgt2</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>

    <span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">s1</span> <span class="o">-</span> <span class="n">s2</span><span class="p">)</span> <span class="k">for</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scores1</span><span class="p">,</span> <span class="n">scores2</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum score difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> (should be 0)&quot;</span><span class="p">)</span>

    <span class="c1"># Cache statistics</span>
    <span class="n">cache_stats</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">get_cache_stats</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cache Statistics:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">cache_stats</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Clear cache and show effect</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Clearing all caches...&quot;</span><span class="p">)</span>
    <span class="n">freqprob</span><span class="o">.</span><span class="n">clear_all_caches</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating third SGT model (cache cleared)...&quot;</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">sgt3</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">SimpleGoodTuring</span><span class="p">(</span><span class="n">small_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">third_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">third_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds (should be similar to first time)&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SGT caching demo failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This can happen with certain frequency distributions&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate custom caching for expensive operations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Custom Caching Example:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Simulate expensive computation</span>


<span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate expensive computation with caching.&quot;&quot;&quot;</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span>  <span class="c1"># Simulate work</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Test caching effect</span>
<span class="n">test_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">repeated_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">test_values</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Repeat first 100 values 5 times</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Testing with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repeated_values</span><span class="p">)</span><span class="si">}</span><span class="s2"> values (many repeats)...&quot;</span><span class="p">)</span>

<span class="c1"># Without cache (clear cache first)</span>
<span class="n">expensive_computation</span><span class="o">.</span><span class="n">cache_clear</span><span class="p">()</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_no_cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test_values</span><span class="p">[:</span><span class="mi">100</span><span class="p">]]</span>  <span class="c1"># Fresh computation</span>
<span class="n">no_cache_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># With cache (subsequent calls)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_with_cache</span> <span class="o">=</span> <span class="p">[</span><span class="n">expensive_computation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">repeated_values</span><span class="p">]</span>  <span class="c1"># Many cached hits</span>
<span class="n">with_cache_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time without cache benefit: </span><span class="si">{</span><span class="n">no_cache_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time with cache benefit:    </span><span class="si">{</span><span class="n">with_cache_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup from caching:      </span><span class="si">{</span><span class="n">no_cache_time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">with_cache_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Cache info</span>
<span class="n">cache_info</span> <span class="o">=</span> <span class="n">expensive_computation</span><span class="o">.</span><span class="n">cache_info</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cache statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hits: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Misses: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">misses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Hit rate: </span><span class="si">{</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">cache_info</span><span class="o">.</span><span class="n">hits</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cache_info</span><span class="o">.</span><span class="n">misses</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="code-output">CACHING AND MEMOIZATION
=========================

Simple Good-Turing Caching Demo:
-----------------------------------
Creating first SGT model (cold cache)...
SGT caching demo failed: name &#39;freqprob&#39; is not defined
This can happen with certain frequency distributions


Custom Caching Example:
-------------------------
Testing with 500 values (many repeats)...
Time without cache benefit: 0.1221 seconds
Time with cache benefit:    0.0003 seconds
Speedup from caching:      2178.7x

Cache statistics:
  Hits: 500
  Misses: 100
  Hit rate: 83.3%</pre>
</div>
<h2>Lazy Evaluation</h2>
<p>Lazy evaluation computes probabilities only when needed, saving time and memory.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">freqprob</span><span class="w"> </span><span class="kn">import</span> <span class="n">LazyBatchScorer</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LAZY EVALUATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Use large dataset for dramatic effect</span>
<span class="n">large_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Working with dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
<span class="p">)</span>

<span class="c1"># Create lazy and eager models</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Creating models...&quot;</span><span class="p">)</span>

<span class="c1"># Eager evaluation (traditional)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">eager_mle</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">eager_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eager MLE creation: </span><span class="si">{</span><span class="n">eager_creation_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Lazy evaluation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_mle</span> <span class="o">=</span> <span class="n">create_lazy_mle</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">lazy_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy MLE creation:  </span><span class="si">{</span><span class="n">lazy_creation_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creation speedup: </span><span class="si">{</span><span class="n">eager_creation_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lazy_creation_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Test queries on subset of elements</span>
<span class="n">test_subset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[::</span><span class="mi">1000</span><span class="p">]</span>  <span class="c1"># Every 1000th element</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Querying </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_subset</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Eager model queries</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">eager_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">eager_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">eager_query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Lazy model queries (first time)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">lazy_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">lazy_query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eager query time: </span><span class="si">{</span><span class="n">eager_query_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy query time:  </span><span class="si">{</span><span class="n">lazy_query_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Verify results are identical</span>
<span class="n">max_diff</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
    <span class="nb">abs</span><span class="p">(</span><span class="n">eager_score</span> <span class="o">-</span> <span class="n">lazy_score</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">eager_score</span><span class="p">,</span> <span class="n">lazy_score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">eager_scores</span><span class="p">,</span> <span class="n">lazy_scores</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum difference: </span><span class="si">{</span><span class="n">max_diff</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Show lazy evaluation statistics</span>
<span class="n">computed_elements</span> <span class="o">=</span> <span class="n">lazy_mle</span><span class="o">.</span><span class="n">get_computed_elements</span><span class="p">()</span>
<span class="n">total_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span>
<span class="n">computation_ratio</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_elements</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Lazy Evaluation Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total elements:    </span><span class="si">{</span><span class="n">total_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computed elements: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computation ratio: </span><span class="si">{</span><span class="n">computation_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory savings:    ~</span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">computation_ratio</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate repeated queries (cached)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Repeated queries (should be cached):&quot;</span><span class="p">)</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">lazy_scores_repeat</span> <span class="o">=</span> <span class="p">[</span><span class="n">lazy_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_subset</span><span class="p">]</span>
<span class="n">lazy_repeat_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lazy repeat time: </span><span class="si">{</span><span class="n">lazy_repeat_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup vs first: </span><span class="si">{</span><span class="n">lazy_query_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lazy_repeat_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

<span class="c1"># Batch lazy evaluation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Batch Lazy Evaluation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Create lazy batch scorer - use the lazy_mle we already created</span>
<span class="n">lazy_batch</span> <span class="o">=</span> <span class="n">LazyBatchScorer</span><span class="p">(</span><span class="n">lazy_mle</span><span class="p">)</span>

<span class="c1"># Test batch processing</span>
<span class="n">batch_test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[::</span><span class="mi">2000</span><span class="p">]</span>  <span class="c1"># Every 2000th element</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">batch_scores</span> <span class="o">=</span> <span class="n">lazy_batch</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span>
<span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch processing time: </span><span class="si">{</span><span class="n">batch_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average per element:   </span><span class="si">{</span><span class="n">batch_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">batch_test_elements</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Demonstrate streaming evaluation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Streaming Evaluation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Create a stream of elements (some repeated)</span>
<span class="n">stream_elements</span> <span class="o">=</span> <span class="n">batch_test_elements</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># Repeat first 5 elements 3 times</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing stream of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements (with repetitions)...&quot;</span><span class="p">)</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">streaming_scores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lazy_batch</span><span class="o">.</span><span class="n">score_streaming</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">))</span>
<span class="n">streaming_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streaming processing time: </span><span class="si">{</span><span class="n">streaming_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average per element:       </span><span class="si">{</span><span class="n">streaming_time</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">stream_elements</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Memory usage comparison (simplified approach)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Usage Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">27</span><span class="p">)</span>

<span class="c1"># Get current process memory for comparison</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>

<span class="n">current_process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
<span class="n">current_memory</span> <span class="o">=</span> <span class="n">current_process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>

<span class="c1"># Estimate memory usage based on computed elements</span>
<span class="n">eager_total_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">large_dataset</span><span class="p">)</span>
<span class="n">lazy_computed_elements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">computed_elements</span><span class="p">)</span>

<span class="c1"># Estimated memory usage (simplified calculation)</span>
<span class="n">estimated_eager_memory</span> <span class="o">=</span> <span class="n">eager_total_elements</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Assume ~0.1KB per element</span>
<span class="n">estimated_lazy_memory</span> <span class="o">=</span> <span class="n">lazy_computed_elements</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Only computed elements</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current process memory:     </span><span class="si">{</span><span class="n">current_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated eager model:      </span><span class="si">{</span><span class="n">estimated_eager_memory</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB (all </span><span class="si">{</span><span class="n">eager_total_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> elements)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Estimated lazy model:       </span><span class="si">{</span><span class="n">estimated_lazy_memory</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB (only </span><span class="si">{</span><span class="n">lazy_computed_elements</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> computed)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computational efficiency:   </span><span class="si">{</span><span class="n">computation_ratio</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> of full computation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory efficiency:          ~</span><span class="si">{</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">computation_ratio</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% savings&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 394 in code block</pre>
</div>
<h2>Streaming Updates and Real-time Learning</h2>
<p>Streaming models allow incremental updates for real-time applications.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STREAMING UPDATES AND REAL-TIME LEARNING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Initialize streaming models</span>
<span class="n">initial_data</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;word_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)}</span>  <span class="c1"># Small initial vocabulary</span>

<span class="n">streaming_mle</span> <span class="o">=</span> <span class="n">StreamingMLE</span><span class="p">(</span><span class="n">initial_data</span><span class="p">,</span> <span class="n">max_vocabulary_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">streaming_laplace</span> <span class="o">=</span> <span class="n">StreamingLaplace</span><span class="p">(</span><span class="n">initial_data</span><span class="p">,</span> <span class="n">max_vocabulary_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial vocabulary size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">initial_data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maximum vocabulary size: 100&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Simulate streaming data</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_streaming_data</span><span class="p">(</span><span class="n">n_updates</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate streaming data with evolving vocabulary.&quot;&quot;&quot;</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Mix of existing and new words</span>
    <span class="n">existing_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">initial_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_updates</span><span class="p">):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">existing_words</span><span class="p">)</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.7</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;new_word_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">stream</span>


<span class="n">streaming_data</span> <span class="o">=</span> <span class="n">generate_streaming_data</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> streaming updates&quot;</span><span class="p">)</span>

<span class="c1"># Process streaming data and track statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing streaming data...&quot;</span><span class="p">)</span>

<span class="n">vocab_sizes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">update_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">probabilities_tracked</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;word_0&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;word_10&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;new_word_100&quot;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Update both models</span>
    <span class="n">streaming_mle</span><span class="o">.</span><span class="n">update_single</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">streaming_laplace</span><span class="o">.</span><span class="n">update_single</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>

    <span class="n">update_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">update_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">update_time</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># Convert to milliseconds</span>

    <span class="c1"># Track statistics every 50 updates</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="o">.</span><span class="n">get_streaming_statistics</span><span class="p">()</span>
        <span class="n">vocab_sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;vocabulary_size&quot;</span><span class="p">])</span>

        <span class="c1"># Track specific word probabilities</span>
        <span class="k">for</span> <span class="n">tracked_word</span> <span class="ow">in</span> <span class="n">probabilities_tracked</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="p">(</span><span class="n">tracked_word</span><span class="p">)</span>
            <span class="n">probabilities_tracked</span><span class="p">[</span><span class="n">tracked_word</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average update time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum update time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">)</span>

<span class="c1"># Final statistics</span>
<span class="n">final_stats</span> <span class="o">=</span> <span class="n">streaming_mle</span><span class="o">.</span><span class="n">get_streaming_statistics</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final Statistics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vocabulary size: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;vocabulary_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total count: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;total_count&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Update count: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;update_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Most frequent: </span><span class="si">{</span><span class="n">final_stats</span><span class="p">[</span><span class="s1">&#39;most_frequent&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize streaming behavior</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Vocabulary size over time</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">streaming_data</span><span class="p">),</span> <span class="mi">50</span><span class="p">),</span> <span class="n">vocab_sizes</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Max vocabulary&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vocabulary Size Over Time&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Updates&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Vocabulary Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Update time distribution</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">update_times</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">),</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">update_times</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> ms&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Update Time Distribution&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Update Time (ms)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Probability evolution</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probabilities_tracked</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">probs</span><span class="p">:</span>  <span class="c1"># Only plot if we have data</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
            <span class="n">probs</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">word</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
            <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Probability Evolution&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Updates&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 4. Model comparison on test words</span>
<span class="n">test_words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;word_0&quot;</span><span class="p">,</span> <span class="s2">&quot;word_25&quot;</span><span class="p">,</span> <span class="s2">&quot;new_word_100&quot;</span><span class="p">,</span> <span class="s2">&quot;unseen_word&quot;</span><span class="p">]</span>
<span class="n">mle_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">streaming_mle</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>
<span class="n">laplace_probs</span> <span class="o">=</span> <span class="p">[</span><span class="n">streaming_laplace</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">test_words</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_words</span><span class="p">))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mle_probs</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Streaming MLE&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">laplace_probs</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Streaming Laplace&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Model Comparison After Streaming&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Test Words&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">test_words</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Key Observations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Vocabulary size stabilizes at the maximum limit&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Update times remain consistently low&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Probabilities adapt to new data in real-time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Streaming Laplace provides smoother probability estimates&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;StreamingMLE&#39; is not defined
  at line 532 in code block</pre>
</div>
<h2>Memory-Efficient Representations</h2>
<p>For large vocabularies, compressed and sparse representations can significantly reduce memory usage.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MEMORY-EFFICIENT REPRESENTATIONS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">33</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create large frequency distribution for demonstration</span>
<span class="n">large_freq_dist</span> <span class="o">=</span> <span class="n">create_realistic_frequency_distribution</span><span class="p">(</span><span class="mi">25000</span><span class="p">,</span> <span class="mi">250000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Original dataset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> words, </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> total count&quot;</span>
<span class="p">)</span>

<span class="c1"># Memory usage of original dictionary</span>
<span class="n">original_size</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">large_freq_dist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">original_size</span> <span class="o">+=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original memory usage: </span><span class="si">{</span><span class="n">original_size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1024</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Create different representations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating memory-efficient representations...&quot;</span><span class="p">)</span>

<span class="c1"># 1. Compressed representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">compressed_dist</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">,</span> <span class="n">quantization_levels</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">compressed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">compressed_memory</span> <span class="o">=</span> <span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="c1"># 2. Sparse representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">sparse_dist</span> <span class="o">=</span> <span class="n">create_sparse_distribution</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span>
<span class="n">sparse_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">sparse_memory</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="c1"># 3. Highly compressed representation</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">highly_compressed</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span>
    <span class="n">large_freq_dist</span><span class="p">,</span> <span class="n">quantization_levels</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">use_compression</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">highly_compressed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="n">highly_compressed_memory</span> <span class="o">=</span> <span class="n">highly_compressed</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compressed creation time:        </span><span class="si">{</span><span class="n">compressed_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sparse creation time:            </span><span class="si">{</span><span class="n">sparse_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Highly compressed creation time: </span><span class="si">{</span><span class="n">highly_compressed_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Memory comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory Usage Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span>

<span class="n">representations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Original Dictionary&quot;</span><span class="p">,</span> <span class="n">original_size</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="n">compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;Sparse&quot;</span><span class="p">,</span> <span class="n">sparse_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
    <span class="p">(</span><span class="s2">&quot;Highly Compressed&quot;</span><span class="p">,</span> <span class="n">highly_compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]),</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">:</span>
    <span class="n">size_mb</span> <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="n">savings</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">size</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;20</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">size_mb</span><span class="si">:</span><span class="s2">6.1f</span><span class="si">}</span><span class="s2"> MB (</span><span class="si">{</span><span class="n">savings</span><span class="si">:</span><span class="s2">+5.1f</span><span class="si">}</span><span class="s2">% vs original)&quot;</span><span class="p">)</span>

<span class="c1"># Accuracy comparison (for compressed representations)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Accuracy Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">test_sample</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span>  <span class="c1"># Test on first 100 words</span>

<span class="c1"># Calculate errors for compressed representations</span>
<span class="n">compressed_errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">highly_compressed_errors</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">original_count</span> <span class="ow">in</span> <span class="n">test_sample</span><span class="p">:</span>
    <span class="n">compressed_count</span> <span class="o">=</span> <span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">highly_compressed_count</span> <span class="o">=</span> <span class="n">highly_compressed</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>

    <span class="n">compressed_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_count</span> <span class="o">-</span> <span class="n">compressed_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_count</span>
    <span class="n">highly_compressed_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">original_count</span> <span class="o">-</span> <span class="n">highly_compressed_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_count</span>

    <span class="n">compressed_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compressed_error</span><span class="p">)</span>
    <span class="n">highly_compressed_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">highly_compressed_error</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Compressed (1024 levels):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean relative error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max relative error:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Highly compressed (256 levels):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Mean relative error: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max relative error:  </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Sparse distribution benefits</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Sparse distribution benefits:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Stored elements: </span><span class="si">{</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_vocabulary_size</span><span class="p">()</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  Storage efficiency: </span><span class="si">{</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_vocabulary_size</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of original&quot;</span>
<span class="p">)</span>

<span class="c1"># Demonstrate sparse operations</span>
<span class="n">top_10</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_top_k</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Top 10 elements: </span><span class="si">{</span><span class="n">top_10</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>  <span class="c1"># Show first 3</span>

<span class="n">mid_freq_elements</span> <span class="o">=</span> <span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_elements_with_count_range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Elements with count 100-1000: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">mid_freq_elements</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualize memory usage breakdown</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Memory usage comparison</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">]</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">size</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">representations</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">]</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage Comparison&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Add value labels on bars</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Accuracy vs compression trade-off</span>
<span class="n">compression_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
<span class="n">mean_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">compressed_errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">highly_compressed_errors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">memory_savings</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">highly_compressed_memory</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">original_size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">memory_savings</span><span class="p">,</span> <span class="n">mean_errors</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;orange&quot;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">compression_levels</span><span class="p">):</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2"> levels&quot;</span><span class="p">,</span>
        <span class="p">(</span><span class="n">memory_savings</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mean_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
        <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">textcoords</span><span class="o">=</span><span class="s2">&quot;offset points&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Accuracy vs Memory Savings Trade-off&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Memory Savings (%)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Relative Error (%)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Performance comparison</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Query Performance Comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">31</span><span class="p">)</span>

<span class="n">query_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">1000</span><span class="p">]</span>

<span class="c1"># Time each representation</span>
<span class="n">query_times</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Original dictionary</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">large_freq_dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Compressed</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">compressed_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Compressed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="c1"># Sparse</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">sparse_dist</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">query_words</span><span class="p">]</span>
<span class="n">query_times</span><span class="p">[</span><span class="s2">&quot;Sparse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time_taken</span> <span class="ow">in</span> <span class="n">query_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">queries_per_sec</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">query_words</span><span class="p">)</span> <span class="o">/</span> <span class="n">time_taken</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;12</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">time_taken</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s (</span><span class="si">{</span><span class="n">queries_per_sec</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> queries/sec)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Key Insights:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Compressed representations can save 50-80% memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Sparse representations excel for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Trade-off between compression ratio and accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Query performance generally comparable&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;create_compressed_distribution&#39; is not defined
  at line 684 in code block</pre>
</div>
<h2>Memory Profiling and Monitoring</h2>
<p>FreqProb provides tools for monitoring memory usage and optimizing performance.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MEMORY PROFILING AND MONITORING&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">33</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Initialize memory profiler</span>
<span class="n">profiler</span> <span class="o">=</span> <span class="n">MemoryProfiler</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory Profiling Demo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">22</span><span class="p">)</span>

<span class="c1"># Profile different operations</span>
<span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Create MLE Model&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="p">(</span>
        <span class="s2">&quot;Create Laplace Model&quot;</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Create Compressed Dist&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">])),</span>
    <span class="p">(</span>
        <span class="s2">&quot;Vectorized Scoring&quot;</span><span class="p">,</span>
        <span class="k">lambda</span><span class="p">:</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">100</span><span class="p">]</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">profiling_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">op_name</span><span class="p">,</span> <span class="n">operation</span> <span class="ow">in</span> <span class="n">operations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Profiling: </span><span class="si">{</span><span class="n">op_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">profiler</span><span class="o">.</span><span class="n">profile_operation</span><span class="p">(</span><span class="n">op_name</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">operation</span><span class="p">()</span>
        <span class="c1"># Force garbage collection to clean measurement</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">get_latest_metrics</span><span class="p">()</span>
    <span class="n">profiling_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">op_name</span><span class="p">,</span> <span class="n">metrics</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory delta: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">memory_delta_mb</span><span class="si">:</span><span class="s2">+6.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Execution time: </span><span class="si">{</span><span class="n">metrics</span><span class="o">.</span><span class="n">execution_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

<span class="c1"># Display profiling summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Profiling Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="n">summary</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">get_memory_summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total snapshots taken: </span><span class="si">{</span><span class="n">summary</span><span class="p">[</span><span class="s1">&#39;total_snapshots&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Fix: Use the correct keys from the actual memory summary structure</span>
<span class="k">if</span> <span class="s2">&quot;rss_memory&quot;</span> <span class="ow">in</span> <span class="n">summary</span><span class="p">:</span>
    <span class="n">rss_memory</span> <span class="o">=</span> <span class="n">summary</span><span class="p">[</span><span class="s2">&quot;rss_memory&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak memory usage: </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;max_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory range: </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;min_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">rss_memory</span><span class="p">[</span><span class="s1">&#39;max_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory summary not available (no snapshots taken)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Analyze memory efficiency of different representations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distribution Memory Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">analyzer</span> <span class="o">=</span> <span class="n">DistributionMemoryAnalyzer</span><span class="p">()</span>

<span class="c1"># Analyze medium dataset</span>
<span class="n">analysis_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzing dataset with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2"> elements...&quot;</span><span class="p">)</span>

<span class="c1"># Measure original distribution</span>
<span class="n">original_memory</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">measure_distribution_memory</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total memory: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Elements: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;num_elements&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;  Memory per element: </span><span class="si">{</span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">original_memory</span><span class="p">[</span><span class="s1">&#39;num_elements&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> KB&quot;</span>
<span class="p">)</span>

<span class="c1"># Compare all representations</span>
<span class="n">comparison</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">compare_representations</span><span class="p">(</span><span class="n">analysis_dataset</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Representation Comparison:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">repr_name</span><span class="p">,</span> <span class="n">memory_info</span> <span class="ow">in</span> <span class="n">comparison</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">repr_name</span> <span class="o">!=</span> <span class="s2">&quot;memory_savings&quot;</span> <span class="ow">and</span> <span class="n">repr_name</span> <span class="o">!=</span> <span class="s2">&quot;profiling_metrics&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">repr_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

        <span class="c1"># Fix: Handle different key structures</span>
        <span class="k">if</span> <span class="s2">&quot;total_mb&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="c1"># Original distribution uses &#39;total_mb&#39;</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total_mb&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;total&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="c1"># Other representations use &#39;total&#39; in bytes</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">memory_mb</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Memory: </span><span class="si">{</span><span class="n">memory_mb</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;creation_time&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Creation time: </span><span class="si">{</span><span class="n">memory_info</span><span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Savings:&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="s2">&quot;memory_savings&quot;</span> <span class="ow">in</span> <span class="n">comparison</span><span class="p">:</span>
    <span class="n">savings</span> <span class="o">=</span> <span class="n">comparison</span><span class="p">[</span><span class="s2">&quot;memory_savings&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">saving_info</span> <span class="ow">in</span> <span class="n">savings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">saving_info</span><span class="p">[</span><span class="s1">&#39;percentage_savings&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% savings&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Absolute: </span><span class="si">{</span><span class="n">saving_info</span><span class="p">[</span><span class="s1">&#39;absolute_savings_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Memory trend monitoring</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Trend Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">23</span><span class="p">)</span>

<span class="c1"># Simulate memory usage over time</span>
<span class="n">memory_monitor</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MemoryMonitor</span><span class="p">(</span><span class="n">memory_threshold_mb</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">monitoring_interval</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">memory_monitor</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">()</span>

<span class="c1"># Simulate workload</span>
<span class="n">workload_memory</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># Create and destroy objects to simulate memory usage</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;temp_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)}</span>
    <span class="n">temp_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">temp_data</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Check memory</span>
    <span class="n">alert</span> <span class="o">=</span> <span class="n">memory_monitor</span><span class="o">.</span><span class="n">check_memory</span><span class="p">()</span>
    <span class="n">current_memory</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
    <span class="n">workload_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_memory</span><span class="p">)</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># Brief pause</span>
    <span class="k">del</span> <span class="n">temp_data</span><span class="p">,</span> <span class="n">temp_model</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

<span class="n">memory_monitor</span><span class="o">.</span><span class="n">stop_monitoring</span><span class="p">()</span>

<span class="c1"># Get monitoring report</span>
<span class="n">monitoring_report</span> <span class="o">=</span> <span class="n">memory_monitor</span><span class="o">.</span><span class="n">get_monitoring_report</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monitoring duration: </span><span class="si">{</span><span class="n">monitoring_report</span><span class="p">[</span><span class="s1">&#39;monitoring_duration&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Memory statistics:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">stat_name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">monitoring_report</span><span class="p">[</span><span class="s2">&quot;memory_statistics&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">stat_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Visualize profiling results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Memory usage by operation</span>
<span class="n">op_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>
<span class="n">memory_deltas</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="o">.</span><span class="n">memory_delta_mb</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>
<span class="n">execution_times</span> <span class="o">=</span> <span class="p">[</span><span class="n">metrics</span><span class="o">.</span><span class="n">execution_time</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">profiling_results</span><span class="p">]</span>

<span class="n">bars</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)),</span> <span class="n">memory_deltas</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Operation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Operations&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Delta (MB)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">op_names</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Add value labels</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">memory_deltas</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># 2. Execution time by operation</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)),</span> <span class="n">execution_times</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Execution Time by Operation&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Operations&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Execution Time (seconds)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">op_names</span><span class="p">)))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">op_names</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 3. Memory efficiency comparison - fix to handle different key structures</span>
<span class="n">repr_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="s2">&quot;Sparse&quot;</span><span class="p">]</span>
<span class="n">memory_usage</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Extract memory usage with proper key handling</span>
<span class="k">for</span> <span class="n">repr_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;original&quot;</span><span class="p">,</span> <span class="s2">&quot;compressed&quot;</span><span class="p">,</span> <span class="s2">&quot;sparse&quot;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="n">repr_name</span> <span class="ow">in</span> <span class="n">comparison</span><span class="p">:</span>
        <span class="n">memory_info</span> <span class="o">=</span> <span class="n">comparison</span><span class="p">[</span><span class="n">repr_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;total_mb&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total_mb&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="s2">&quot;total&quot;</span> <span class="ow">in</span> <span class="n">memory_info</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">memory_info</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">memory_usage</span> <span class="ow">and</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Only plot if we have valid data</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">repr_names</span><span class="p">,</span> <span class="n">memory_usage</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>

    <span class="c1"># Add percentage savings</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">usage</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">memory_usage</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Skip original</span>
            <span class="n">savings_pct</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">usage</span> <span class="o">/</span> <span class="n">memory_usage</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;-</span><span class="si">{</span><span class="n">savings_pct</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
                <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
            <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="s2">&quot;Memory comparison data not available&quot;</span><span class="p">,</span>
        <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>

<span class="c1"># 4. Memory trend during workload</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">workload_memory</span><span class="p">)),</span> <span class="n">workload_memory</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage During Workload&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time Steps&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add threshold line if available</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Threshold&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Recommendations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Memory Optimization Recommendations:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">38</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Use compressed representations for large vocabularies (50</span><span class="si">%+ s</span><span class="s2">avings)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Consider sparse representations for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Monitor memory usage during long-running processes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Use streaming models for real-time applications with bounded memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5. Profile operations to identify memory bottlenecks&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;6. Implement garbage collection strategies for batch processing&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;MemoryProfiler&#39; is not defined
  at line 873 in code block</pre>
</div>
<h2>Performance Benchmarks and Best Practices</h2>
<p>Let's conclude with comprehensive benchmarks and practical recommendations.</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PERFORMANCE BENCHMARKS AND BEST PRACTICES&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">44</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Comprehensive benchmark suite</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_comprehensive_benchmark</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run comprehensive performance benchmark.&quot;&quot;&quot;</span>

    <span class="n">benchmark_results</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Test datasets of different sizes</span>
    <span class="n">test_datasets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Small (1K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">],</span>
        <span class="s2">&quot;Large (50K)&quot;</span><span class="p">:</span> <span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">test_datasets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Benchmarking </span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="n">dataset_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">test_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))]</span>

        <span class="c1"># 1. Model creation time</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">create_mle</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">create_laplace</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">Laplace</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">create_lazy_mle_func</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">create_lazy_mle</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">models_to_test</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="n">create_mle</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="n">create_laplace</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">,</span> <span class="n">create_lazy_mle_func</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_creator</span> <span class="ow">in</span> <span class="n">models_to_test</span><span class="p">:</span>
            <span class="c1"># Creation time</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">model_creator</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># Query time</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">[:</span><span class="mi">100</span><span class="p">]]</span>
            <span class="n">query_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="n">dataset_results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="n">creation_time</span><span class="p">,</span>
                <span class="s2">&quot;query_time&quot;</span><span class="p">:</span> <span class="n">query_time</span><span class="p">,</span>
                <span class="s2">&quot;queries_per_sec&quot;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">query_time</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="c1"># 2. Vectorized vs individual scoring</span>
        <span class="n">mle_model</span> <span class="o">=</span> <span class="n">freqprob</span><span class="o">.</span><span class="n">MLE</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">logprob</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">vectorized_model</span> <span class="o">=</span> <span class="n">VectorizedScorer</span><span class="p">(</span><span class="n">mle_model</span><span class="p">)</span>

        <span class="c1"># Individual scoring</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">mle_model</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">test_elements</span><span class="p">]</span>
        <span class="n">individual_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="c1"># Batch scoring</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">vectorized_model</span><span class="o">.</span><span class="n">score_batch</span><span class="p">(</span><span class="n">test_elements</span><span class="p">)</span>
        <span class="n">batch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="n">dataset_results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;individual_time&quot;</span><span class="p">:</span> <span class="n">individual_time</span><span class="p">,</span>
            <span class="s2">&quot;batch_time&quot;</span><span class="p">:</span> <span class="n">batch_time</span><span class="p">,</span>
            <span class="s2">&quot;speedup&quot;</span><span class="p">:</span> <span class="n">individual_time</span> <span class="o">/</span> <span class="n">batch_time</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># 3. Memory representations</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">5000</span><span class="p">:</span>  <span class="c1"># Only for larger datasets</span>
            <span class="c1"># Compressed</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">create_compressed_distribution</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">compressed_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="c1"># Sparse</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">sparse</span> <span class="o">=</span> <span class="n">create_sparse_distribution</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
            <span class="n">sparse_creation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

            <span class="n">dataset_results</span><span class="p">[</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;compressed_creation&quot;</span><span class="p">:</span> <span class="n">compressed_creation_time</span><span class="p">,</span>
                <span class="s2">&quot;sparse_creation&quot;</span><span class="p">:</span> <span class="n">sparse_creation_time</span><span class="p">,</span>
                <span class="s2">&quot;compressed_memory&quot;</span><span class="p">:</span> <span class="n">compressed</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
                <span class="s2">&quot;sparse_memory&quot;</span><span class="p">:</span> <span class="n">sparse</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset_results</span>

    <span class="k">return</span> <span class="n">benchmark_results</span>


<span class="c1"># Run benchmarks</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running comprehensive benchmarks...&quot;</span><span class="p">)</span>
<span class="n">benchmark_results</span> <span class="o">=</span> <span class="n">run_comprehensive_benchmark</span><span class="p">()</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Benchmark Results:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">18</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">benchmark_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">dataset_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">))</span>

    <span class="c1"># Model performance</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model Performance:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="s2">&quot;Lazy MLE&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">model_name</span><span class="si">:</span><span class="s2">&lt;10</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;creation_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s creation, </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;queries_per_sec&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">,.0f</span><span class="si">}</span><span class="s2"> queries/sec&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Vectorization performance</span>
    <span class="k">if</span> <span class="s2">&quot;Vectorization&quot;</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Vectorization: </span><span class="si">{</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;speedup&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x speedup&quot;</span><span class="p">)</span>

    <span class="c1"># Memory representations</span>
    <span class="k">if</span> <span class="s2">&quot;Memory Representations&quot;</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory (Compressed): </span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;compressed_memory&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Memory (Sparse): </span><span class="si">{</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;sparse_memory&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

<span class="c1"># Performance scaling analysis</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Performance Scaling Analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">31</span><span class="p">)</span>

<span class="n">dataset_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;small&quot;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;medium&quot;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">[</span><span class="s2">&quot;large&quot;</span><span class="p">])]</span>
<span class="n">mle_creation_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lazy_creation_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">vectorization_speedups</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Small (1K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="n">mle_creation_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">][</span><span class="s2">&quot;creation_time&quot;</span><span class="p">])</span>
    <span class="n">lazy_creation_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">][</span><span class="s2">&quot;creation_time&quot;</span><span class="p">])</span>
    <span class="n">vectorization_speedups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;Vectorization&quot;</span><span class="p">][</span><span class="s2">&quot;speedup&quot;</span><span class="p">])</span>

<span class="c1"># Visualize scaling</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># 1. Creation time scaling</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">mle_creation_times</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">lazy_creation_times</span><span class="p">,</span> <span class="s2">&quot;s-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Lazy MLE&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Model Creation Time Scaling&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Creation Time (seconds)&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 2. Vectorization speedup</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="p">,</span> <span class="n">vectorization_speedups</span><span class="p">,</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Vectorization Speedup by Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Speedup Factor&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># 3. Memory usage comparison (for larger datasets)</span>
<span class="n">memory_datasets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]</span>
<span class="n">compressed_memory</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">sparse_memory</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="n">memory_datasets</span><span class="p">:</span>
    <span class="k">if</span> <span class="s2">&quot;Memory Representations&quot;</span> <span class="ow">in</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">][</span><span class="s2">&quot;Memory Representations&quot;</span><span class="p">]</span>
        <span class="n">compressed_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;compressed_memory&quot;</span><span class="p">])</span>
        <span class="n">sparse_memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="s2">&quot;sparse_memory&quot;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">compressed_memory</span> <span class="ow">and</span> <span class="n">sparse_memory</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">memory_datasets</span><span class="p">))</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.35</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">compressed_memory</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Compressed&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sparse_memory</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sparse&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Memory Usage by Representation&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Memory Usage (MB)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">memory_datasets</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># 4. Queries per second comparison</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Laplace&quot;</span><span class="p">,</span> <span class="s2">&quot;Lazy MLE&quot;</span><span class="p">]</span>
<span class="n">queries_per_sec</span> <span class="o">=</span> <span class="p">{</span><span class="n">model</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">}</span>

<span class="k">for</span> <span class="n">dataset_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Small (1K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium (10K)&quot;</span><span class="p">,</span> <span class="s2">&quot;Large (50K)&quot;</span><span class="p">]:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">benchmark_results</span><span class="p">[</span><span class="n">dataset_name</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">model_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">queries_per_sec</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">][</span><span class="s2">&quot;queries_per_sec&quot;</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">([</span><span class="s2">&quot;Small&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Large&quot;</span><span class="p">]))</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">qps_values</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">queries_per_sec</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">qps_values</span><span class="p">:</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">width</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">qps_values</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Query Performance by Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Dataset Size&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Queries per Second&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;Small&quot;</span><span class="p">,</span> <span class="s2">&quot;Medium&quot;</span><span class="p">,</span> <span class="s2">&quot;Large&quot;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Best practices summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">BEST PRACTICES SUMMARY&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">23</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🚀 PERFORMANCE OPTIMIZATION:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Use vectorized operations for batch processing (2-10x speedup)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Choose lazy evaluation for sparse access patterns&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Implement caching for expensive computations (SGT, etc.)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Profile operations to identify bottlenecks&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💾 MEMORY MANAGEMENT:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Use compressed representations for large vocabularies (50</span><span class="si">%+ s</span><span class="s2">avings)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Consider sparse representations for distributions with many zeros&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Implement streaming for real-time applications&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Monitor memory usage and set appropriate limits&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;⚖️ TRADE-OFFS TO CONSIDER:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Accuracy vs. Memory: Higher compression = lower accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Speed vs. Memory: Eager computation = faster queries, more memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Complexity vs. Performance: Advanced methods may not always be better&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Real-time vs. Batch: Streaming good for real-time, batch good for throughput&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🎯 CHOOSING THE RIGHT APPROACH:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Small datasets (&lt;10K): Standard implementations sufficient&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Medium datasets (10K-100K): Consider vectorization and compression&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Large datasets (&gt;100K): Use streaming, compression, and lazy evaluation&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Real-time applications: Streaming models with bounded memory&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Batch processing: Vectorized operations with memory monitoring&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🔧 IMPLEMENTATION CHECKLIST:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Profile your specific use case&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Choose appropriate data representations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Implement memory monitoring&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Test with realistic data sizes&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Validate accuracy vs. efficiency trade-offs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  ☐ Plan for scaling and growth&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre class="error">NameError: name &#39;freqprob&#39; is not defined
  at line 1119 in code block</pre>
</div>
<h2>Summary and Next Steps</h2>
<p>In this tutorial, you learned how to optimize FreqProb for large-scale, production applications:</p>
<h3>Key Techniques Covered:</h3>
<ol>
<li><strong>Vectorized Operations</strong> - 2-10x speedup for batch processing</li>
<li><strong>Caching and Memoization</strong> - Automatic optimization for expensive computations</li>
<li><strong>Lazy Evaluation</strong> - Compute only what's needed, save memory</li>
<li><strong>Streaming Updates</strong> - Real-time learning with bounded memory</li>
<li><strong>Memory-Efficient Representations</strong> - 50-80% memory savings for large vocabularies</li>
<li><strong>Memory Profiling</strong> - Monitor and optimize memory usage</li>
</ol>
<h3>Performance Insights:</h3>
<ul>
<li><strong>Vectorization</strong> provides consistent speedups across dataset sizes</li>
<li><strong>Lazy evaluation</strong> is most beneficial for sparse access patterns</li>
<li><strong>Compressed representations</strong> offer significant memory savings with minimal accuracy loss</li>
<li><strong>Streaming models</strong> enable real-time applications with predictable memory usage</li>
</ul>
<h3>When to Use What:</h3>
<ul>
<li><strong>Small datasets</strong> (&lt;10K): Standard implementations are sufficient</li>
<li><strong>Medium datasets</strong> (10K-100K): Add vectorization and consider compression</li>
<li><strong>Large datasets</strong> (&gt;100K): Use all efficiency features</li>
<li><strong>Real-time applications</strong>: Streaming models with memory monitoring</li>
<li><strong>Batch processing</strong>: Vectorized operations with profiling</li>
</ul>
<h3>Next Steps:</h3>
<ol>
<li><strong>Apply these techniques</strong> to your specific use case</li>
<li><strong>Profile your applications</strong> to identify bottlenecks</li>
<li><strong>Try Tutorial 4</strong>: Real-world NLP Applications</li>
<li><strong>Experiment</strong> with different combinations of techniques</li>
<li><strong>Scale gradually</strong> and monitor performance metrics</li>
</ol>
<p>Remember: <strong>optimization is application-specific</strong>. Always profile your specific use case and validate that optimizations actually improve performance for your data and usage patterns!</p>

<div class="code-block">
<div class="code-input"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</body>
</html>